# Define common ignore intents as YAML anchors
x-common-ignore-intents: &common-ignore-intents
  - affirm
  - deny
  - skip
  - introduce
  - bot_challenge
  - nav_back
  - nav_menu
  - nav_main_menu
  - nav_exit
  - nav_goodbye
  - nav_clear
  - nav_close_browser_tab
  - nav_introduce
  - nav_restart
  - restart
  - mood_great
  - mood_unhappy
  - phone_number_intent
  - slot_extraction
  - start_status_check
  - affirm_sensitive_content
  - deny_sensitive_content
  - nlu_fallback
  - full_names_english_with_middle_name
  - full_names_nepali_with_middle_name
  - full_names_english
  - full_names_nepali
  - location_names_english
  - location_names_nepali
  - status_check_modify
  - status_check_follow_up
  - status_check_request_follow_up
  - status_check_modify_grievance
  - status_check_provide_contact
  - status_check_do_not_provide_contact
  - route_status_check_phone
  - route_status_check_grievance_id
  - new_grievance
  - status_check

version: "3.1"
session_config:
  session_expiration_time: 300 # 5 minutes instead of 1 minute
  carry_over_slots_to_new_session: true

intents:
  - action_session_start
  - affirm
  - attach_files
  - bot_challenge
  - deny
  - grievance_process_start
  - grievance_submit_as_is
  - introduce
  - mood_great
  - mood_unhappy
  - nav_back
  - nav_clear
  - nav_close_browser_tab
  - nav_exit
  - nav_goodbye
  - nav_introduce
  - nav_main_menu
  - nav_restart
  - restart
  - nlu_fallback
  - phone_number_intent
  - question_attach_files
  - set_english
  - set_nepali
  - skip
  - new_grievance
  - start_status_check
  - test_tracker_access
  - test_disconnection
  - test_disconnection_log
  - status_check
  - status_check_modify
  - status_check_follow_up
  - status_check_request_follow_up
  - status_check_modify_grievance
  - status_check_provide_contact
  - status_check_do_not_provide_contact
  - full_names_english_with_middle_name
  - full_names_nepali_with_middle_name
  - full_names_english
  - full_names_nepali
  - location_names_english
  - location_names_nepali
  - route_status_check_phone
  - route_status_check_grievance_id

slots:
  language_code:
    type: categorical
    influence_conversation: false
    values:
      - en
      - ne
    mappings:
      - type: custom
  current_process:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  restart_type:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  previous_state:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  story_current:
    type: text
    influence_conversation: false
    mappings:
      - type: custom

  story_main:
    type: categorical
    values:
      - status_check
      - new_grievance
      - new_complainant
      - modify_grievance
      - modify_contact
    influence_conversation: true
    mappings:
      - type: custom
  story_route:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  story_step:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  classification_task_id:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  complainant_location_consent:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  complainant_municipality_temp:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  complainant_municipality:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  complainant_municipality_confirmed:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  provide_additional_location:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  complainant_ward:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  complainant_village_temp:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  complainant_village:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  complainant_village_confirmed:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  complainant_address:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  complainant_address_confirmed:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  complainant_address_temp:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  complainant_province:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  complainant_district:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  complainant_office:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  flask_session_id:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  complainant_project:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  last_message_saved:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  complainant_phone:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  complainant_phone_valid:
    type: bool
    influence_conversation: false
    mappings:
      - type: custom
  complainant_consent:
    type: bool
    influence_conversation: false
    mappings:
      - type: custom
  complainant_email_temp:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  complainant_email_confirmed:
    type: bool
    influence_conversation: false
    mappings:
      - type: custom
  complainant_email:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  complainant_full_name:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  complainant_gender:
    type: categorical
    values:
      - male
      - female
      - other
    mappings:
      - type: custom
  phone_validation_required:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  contact_modification_mode:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
      - type: custom
  otp_consent:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  otp_number:
    type: text
    mappings:
      - type: custom
  otp_status:
    type: categorical
    values:
      - verified
      - invalid_otp
      - resend
      - slot_skipped
    mappings:
      - type: custom
  otp_verified:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  otp_input:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  otp_resend_count:
    type: float
    initial_value: 0
    influence_conversation: false
    mappings:
      - type: custom
  grievance_id:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  complainant_id:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  utter_count:
    type: float
    initial_value: 0
    influence_conversation: false
    mappings:
      - type: custom
  skip_count:
    type: float
    initial_value: 0
    influence_conversation: false
    mappings:
      - type: custom
  follow_up_question:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  grievance_complainant_review:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  grievance_categories:
    type: list
    influence_conversation: true
    mappings:
      - type: custom
  grievance_categories_alternative:
    type: list
    influence_conversation: true
    mappings:
      - type: custom
  grievance_categories_local:
    type: list
    influence_conversation: true
    mappings:
      - type: custom
  grievance_categories_alternative_local:
    type: list
    influence_conversation: true
    mappings:
      - type: custom
  grievance_categories_status:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  grievance_cat_modify:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  grievance_classification_status:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  grievance_classification_consent:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  grievance_summary:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  grievance_summary_status:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  grievance_summary_temp:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  grievance_date:
    type: text
    mappings:
      - type: custom
  grievance_claimed_amount:
    type: text
    mappings:
      - type: custom
  dismissed_categories:
    type: list
    mappings:
      - type: custom
  grievance_status:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  grievance_status_update_date:
    type: text
    mappings:
      - type: custom
  grievance_temp:
    type: text
    mappings:
      - type: custom
  grievance_new_detail:
    type: text
    mappings:
      - type: custom
  grievance_description:
    type: text
    mappings:
      - type: custom
  grievance_description_status:
    type: text
    mappings:
      - type: custom
  skip_validation_needed:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  skipped_detected_text:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  is_temporary:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  file_references:
    type: list
    influence_conversation: true
    mappings:
      - type: custom
  file_upload_status:
    type: text
    mappings:
      - type: custom
  grievance_sensitive_issue:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  sensitive_issues_category:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  sensitive_issues_level:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  sensitive_issues_message:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  sensitive_issues_confidence:
    type: float
    influence_conversation: false
    mappings:
      - type: custom
  sensitive_issues_follow_up:
    type: bool
    influence_conversation: false
    mappings:
      - type: custom
  sensitive_issues_nickname:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  sensitive_issues_new_detail:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  status_check_grievance_selected:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  data_to_emit:
    type: any
    influence_conversation: false
    mappings:
      - type: custom
  translation_status:
    type: text
    mappings:
      - type: custom
  set_next_action:
    type: bool
    influence_conversation: false
    mappings:
      - type: custom
  form_next_action:
    type: bool
    influence_conversation: false
    mappings:
      - type: custom

  valid_province_and_district:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  status_check_retrieve_grievances:
    type: bool
    influence_conversation: false
    mappings:
      - type: custom

  list_grievance_id:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  list_grievance_id_valid:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  status_check_complainant_phone_valid:
    type: categorical
    values:
      - invalid_number
      - no_phone_found
      - true6
    influence_conversation: true
    mappings:
      - type: custom
  list_grievances_by_phone:
    type: list
    influence_conversation: true
    mappings:
      - type: custom
  status_check_complainant_full_name:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  status_check_full_name_validated:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  status_check_complainant_full_name_valid:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  complainant_list_full_names:
    type: list
    influence_conversation: true
    mappings:
      - type: custom
  status_check_grievance_id_selected:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  status_check_grievance_id_selected_status:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
    # Test slots for disconnection testing
  additional_description:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  test_disconnection_logged:
    type: bool
    influence_conversation: false
    mappings:
      - type: custom
  tracker_access_test_passed:
    type: bool
    influence_conversation: false
    mappings:
      - type: custom
  disconnection_simulation_completed:
    type: bool
    influence_conversation: false
    mappings:
      - type: custom

actions:
  - action_next_action
  - action_retrieve_classification_results

  - action_complainant_address_confirmed
  - action_complainant_address_temp
  - action_complainant_consent
  - action_complainant_email_confirmed
  - action_complainant_email_temp
  - action_complainant_district
  - action_complainant_full_name
  - action_complainant_location_consent
  - action_complainant_municipality_confirmed
  - action_complainant_municipality_temp
  - action_complainant_province
  - action_complainant_village_confirmed
  - action_complainant_village_temp
  - action_complainant_ward
  - action_ask_grievance_new_detail
  - action_ask_sensitive_issues_follow_up
  - action_ask_sensitive_issues_nickname
  - action_ask_sensitive_issues_new_detail
  - action_ask_form_sensitive_issues_complainant_phone
  - action_ask_form_story_main_language_code
  - action_ask_form_story_main_story_main
  - action_ask_complainant_phone
  - action_ask_otp_consent
  - action_ask_otp_input
  - action_ask_otp_number
  - action_ask_status_check_retrieve_grievances
  - action_ask_form_grievance_complainant_review_grievance_classification_consent
  - action_ask_form_grievance_complainant_review_grievance_cat_modify
  - action_ask_form_grievance_complainant_review_grievance_summary_status
  - action_ask_form_grievance_complainant_review_grievance_summary_temp
  - action_ask_form_grievance_complainant_review_grievance_categories_status
  - action_ask_form_grievance_complainant_review_grievance_gender_follow_up
  - action_attach_file
  - action_back_to_previous_step
  - action_check_status
  - action_start_status_check
  - action_choose_retrieval_method
  - action_ask_status_check_method
  - action_ask_status_check_list_grievance_id
  - action_ask_status_check_complainant_phone
  - action_ask_status_check_complainant_full_name
  - action_ask_status_check_grievance_id_selected
  - action_ask_valid_province_and_district
  - action_display_grievance_id
  - action_display_grievance_details_init
  - action_display_grievance_details
  - action_test_tracker_access
  - action_simulate_disconnection
  - action_clear_session
  - action_close_browser_tab
  - action_continue
  - action_custom_fallback
  - action_default_fallback
  - action_display_grievance
  - action_exit_without_filing
  - action_handle_classification_results
  - action_go_back
  - action_goodbye
  - action_handle_mood_great
  - action_handle_mood_unhappy
  - action_handle_skip
  - action_introduce
  - action_main_menu
  - action_mood_unhappy
  - action_question_attach_files
  - action_recommend_phone_validation
  - action_respond_to_challenge
  - action_restart_grievance
  - action_restart_story
  - action_retrieve_another_grievance
  - action_route_status_check_phone
  - action_retry_otp
  - action_session_start
  - action_set_current_process
  - action_set_english
  - action_set_grievance_id
  - action_set_nepali
  - action_show_story_current
  - action_show_status_history
  - action_skip_status_check_outro
  - action_start_grievance_process
  - action_submit_grievance
  - action_submit_grievance_as_is
  - action_test_disconnection_log
  - action_test_disconnection
  - action_update_grievance_categorization
  - action_validate_categories
  - action_validate_summary
  - action_handle_sensitive_content_affirm
  - action_handle_sensitive_content_deny
  - validate_form_contact
  - validate_form_grievance
  - validate_form_grievance_complainant_review
  - validate_form_grievance_id
  - validate_form_story_main
  - validate_form_story_route
  - validate_form_story_step
  - validate_form_otp
  - validate_form_status_check
  - validate_form_status_check_1
  - validate_form_status_check_2
  - validate_form_sensitive_issues
  - validate_form_status_check_skip
  - action_grievance_outro
  - action_status_check_request_follow_up
  - action_status_check_modify_grievance
  - action_status_check_retrieve_complainant_data
  - action_ask_story_route
  - action_ask_story_step
  - action_ask_story_main

forms:
  form_contact:
    required_slots:
      - complainant_location_consent
      - complainant_full_name
      - complainant_email_temp
    ignored_intents: *common-ignore-intents
  collect_phone_form:
    required_slots:
      - complainant_phone
    ignored_intents: *common-ignore-intents
  edit_summary_form:
    required_slots:
      - grievance_summary
    ignored_intents: *common-ignore-intents
  form_otp:
    required_slots:
      - otp_input
      - otp_status
    ignored_intents: *common-ignore-intents
  grievance_id_form:
    required_slots:
      - grievance_id
    ignored_intents: *common-ignore-intents
  form_grievance:
    required_slots:
      - grievance_new_detail
    ignored_intents: *common-ignore-intents
  form_grievance_complainant_review:
    required_slots:
      - grievance_cat_modify
    ignored_intents: *common-ignore-intents
  form_sensitive_issues:
    required_slots:
      - sensitive_issues_follow_up
    ignored_intents: *common-ignore-intents
  form_status_check_1:
    required_slots:
      - story_route
    ignored_intents: *common-ignore-intents
  form_status_check_2:
    required_slots:
      - status_check_retrieve_grievances
    ignored_intents: *common-ignore-intents
  form_status_check_skip:
    required_slots:
      - valid_province_and_district
    ignored_intents: *common-ignore-intents
  form_story_main:
    required_slots:
      - story_main
    ignored_intents: *common-ignore-intents
  form_story_route:
    required_slots:
      - story_route
    ignored_intents: *common-ignore-intents
  form_story_step:
    required_slots:
      - story_step
    ignored_intents: *common-ignore-intents
  form_status_check_modify:
    required_slots:
      - story_step
    ignored_intents: *common-ignore-intents

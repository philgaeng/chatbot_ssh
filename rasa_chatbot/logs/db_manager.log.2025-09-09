2025-09-09 08:13:01,723 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:13:01,723 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:13:01,723 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:13:01,724 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:13:01,724 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:13:01,724 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:13:01,724 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:13:01,724 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:13:01,724 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:13:01,724 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:13:01,724 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:13:01,724 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:13:01,724 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:13:01,724 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:13:01,724 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:13:01,724 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:13:01,724 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:13:01,724 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:13:01,724 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:13:01,724 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:13:01,724 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:13:01,724 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:13:01,724 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:13:01,724 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:13:01,724 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:13:01,724 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:13:01,725 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:13:01,725 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:13:01,725 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:13:01,725 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:14:27,524 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-EAE2-B
2025-09-09 08:14:27,524 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-EAE2-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-EAE2-B'}
2025-09-09 08:14:27,524 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 08:14:27,524 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 08:14:27,524 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 08:14:27,524 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 08:14:27,524 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:14:27,531 - db_manager - INFO - Starting database transaction
2025-09-09 08:14:27,536 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:14:27,536 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:14:27,537 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-EAE2-B
2025-09-09 08:14:27,537 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-83DC-B', 'complainant_id': 'CM-20250909-KOJH-EAE2-B', 'grievance_description': 'dust everywhere kids are coughing so much need to go to hospital', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-EAE2-B'}
2025-09-09 08:14:27,537 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-83DC-B
2025-09-09 08:14:27,537 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 08:14:27,537 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 08:14:27,537 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 08:14:27,537 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 08:14:27,537 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:14:27,543 - db_manager - INFO - Starting database transaction
2025-09-09 08:14:27,552 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:14:27,553 - db_manager - INFO - Database connection closed. Duration: 0.02s
2025-09-09 08:14:27,553 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-83DC-B
2025-09-09 08:14:58,481 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:14:58,487 - db_manager - INFO - Starting database transaction
2025-09-09 08:14:58,487 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 08:14:58,490 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 08:14:58,490 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:14:58,490 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:14:58,490 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:14:58,495 - db_manager - INFO - Starting database transaction
2025-09-09 08:14:58,495 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 08:14:58,497 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 08:14:58,497 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:14:58,497 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:14:58,497 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-83DC-B', 'complainant_id': 'CM-20250909-KOJH-EAE2-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'धूलो ताता, बालबालिकाहरु धेरै खोक्दै, अस्पताल जानु पर्दैछ', 'grievance_description': 'dust everywhere kids are coughing so much need to go to hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 14, 27, 543818, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 14, 32, 591191, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-83DC-B', 'complainant_id': 'CM-20250909-KOJH-EAE2-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'धूलो ताता, बालबालिकाहरु धेरै खोक्दै, अस्पताल जानु पर्दैछ', 'grievance_description': 'dust everywhere kids are coughing so much need to go to hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 14, 27, 543818, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 14, 32, 591191, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 08:14:58,498 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-EAE2-B
2025-09-09 08:14:58,498 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:14:58,502 - db_manager - INFO - Starting database transaction
2025-09-09 08:14:58,502 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:14:58,506 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:14:58,506 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:14:58,506 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:14:58,506 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:14:58,511 - db_manager - INFO - Starting database transaction
2025-09-09 08:14:58,511 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:14:58,512 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:14:58,512 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:14:58,512 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:14:58,512 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:14:58,517 - db_manager - INFO - Starting database transaction
2025-09-09 08:14:58,517 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:14:58,518 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:14:58,518 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:14:58,518 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:14:58,518 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d0407030203af7154b080dbfe62d23d0100e0aedad16eb99dc99c2333af938b3ca403e1a9dedb10d058a0ea3c2d1d2b904516ef9b8efd950023dad5d62f6e03cd696625aecd6b024a21c336c4
2025-09-09 08:14:58,519 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 08:14:58,519 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d0407030252cf35df62adda4763d23d010fb8983ccf3c7eec3a434c2fe33331f34390e7a0e83e965858d3daf028552bd95d3d7de78a220af97cd1546d6581a039c338371ca90a3030caf955db', 'complainant_phone': 'c30d0407030203af7154b080dbfe62d23d0100e0aedad16eb99dc99c2333af938b3ca403e1a9dedb10d058a0ea3c2d1d2b904516ef9b8efd950023dad5d62f6e03cd696625aecd6b024a21c336c4', 'complainant_email': 'c30d04070302ec373ca6cf1ec23372d23d01c564f373710551454c3689e482765215cb429d6e176d5a84a18b86f873c13a7d016d33db32b3a4ea9ff0f33ef3b57a0a28f8df0938254d761976479c', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 08:14:58,519 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d0407030252cf35df62adda4763d23d010fb8983ccf3c7eec3a434c2fe33331f34390e7a0e83e965858d3daf028552bd95d3d7de78a220af97cd1546d6581a039c338371ca90a3030caf955db', 'complainant_phone': 'c30d0407030203af7154b080dbfe62d23d0100e0aedad16eb99dc99c2333af938b3ca403e1a9dedb10d058a0ea3c2d1d2b904516ef9b8efd950023dad5d62f6e03cd696625aecd6b024a21c336c4', 'complainant_email': 'c30d04070302ec373ca6cf1ec23372d23d01c564f373710551454c3689e482765215cb429d6e176d5a84a18b86f873c13a7d016d33db32b3a4ea9ff0f33ef3b57a0a28f8df0938254d761976479c', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 08:14:58,519 - db_manager - DEBUG - execute_update values: ('c30d0407030252cf35df62adda4763d23d010fb8983ccf3c7eec3a434c2fe33331f34390e7a0e83e965858d3daf028552bd95d3d7de78a220af97cd1546d6581a039c338371ca90a3030caf955db', 'c30d0407030203af7154b080dbfe62d23d0100e0aedad16eb99dc99c2333af938b3ca403e1a9dedb10d058a0ea3c2d1d2b904516ef9b8efd950023dad5d62f6e03cd696625aecd6b024a21c336c4', 'c30d04070302ec373ca6cf1ec23372d23d01c564f373710551454c3689e482765215cb429d6e176d5a84a18b86f873c13a7d016d33db32b3a4ea9ff0f33ef3b57a0a28f8df0938254d761976479c', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-EAE2-B')
2025-09-09 08:14:58,519 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_email_hash = %s, complainant_full_name_hash = %s, complainant_phone_hash = %s WHERE complainant_id = %s
2025-09-09 08:14:58,519 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:14:58,524 - db_manager - INFO - Starting database transaction
2025-09-09 08:14:58,524 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 08:14:58,525 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:14:58,527 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:14:58,527 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:14:58,528 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-EAE2-B
2025-09-09 08:14:58,528 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-83DC-B
2025-09-09 08:14:58,528 - db_manager - DEBUG - execute_update values: ('dust everywhere kids are coughing so much need to go to hospital', 'GR-20250909-KOJH-83DC-B')
2025-09-09 08:14:58,528 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 08:14:58,528 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:14:58,534 - db_manager - INFO - Starting database transaction
2025-09-09 08:14:58,534 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 08:14:58,535 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:14:58,538 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:14:58,538 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:14:58,538 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-83DC-B, rows affected: 1
2025-09-09 08:14:58,538 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-83DC-B
2025-09-09 08:14:58,538 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:14:58,543 - db_manager - INFO - Starting database transaction
2025-09-09 08:14:58,543 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:14:58,545 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:14:58,546 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:14:58,546 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:14:58,546 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:14:58,551 - db_manager - INFO - Starting database transaction
2025-09-09 08:14:58,551 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:14:58,552 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:14:58,552 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:14:58,552 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:14:58,600 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:14:58,605 - db_manager - INFO - Starting database transaction
2025-09-09 08:14:58,605 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 08:14:58,607 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 08:14:58,607 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:14:58,607 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:14:58,607 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-83DC-B', 'complainant_id': 'CM-20250909-KOJH-EAE2-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'धूलो ताता, बालबालिकाहरु धेरै खोक्दै, अस्पताल जानु पर्दैछ', 'grievance_description': 'dust everywhere kids are coughing so much need to go to hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 14, 27, 543818, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 14, 58, 534310, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d0407030252cf35df62adda4763d23d010fb8983ccf3c7eec3a434c2fe33331f34390e7a0e83e965858d3daf028552bd95d3d7de78a220af97cd1546d6581a039c338371ca90a3030caf955db', 'complainant_phone': 'c30d0407030203af7154b080dbfe62d23d0100e0aedad16eb99dc99c2333af938b3ca403e1a9dedb10d058a0ea3c2d1d2b904516ef9b8efd950023dad5d62f6e03cd696625aecd6b024a21c336c4', 'complainant_email': 'c30d04070302ec373ca6cf1ec23372d23d01c564f373710551454c3689e482765215cb429d6e176d5a84a18b86f873c13a7d016d33db32b3a4ea9ff0f33ef3b57a0a28f8df0938254d761976479c', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-83DC-B', 'complainant_id': 'CM-20250909-KOJH-EAE2-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'धूलो ताता, बालबालिकाहरु धेरै खोक्दै, अस्पताल जानु पर्दैछ', 'grievance_description': 'dust everywhere kids are coughing so much need to go to hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 14, 27, 543818, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 14, 58, 534310, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d0407030252cf35df62adda4763d23d010fb8983ccf3c7eec3a434c2fe33331f34390e7a0e83e965858d3daf028552bd95d3d7de78a220af97cd1546d6581a039c338371ca90a3030caf955db', 'complainant_phone': 'c30d0407030203af7154b080dbfe62d23d0100e0aedad16eb99dc99c2333af938b3ca403e1a9dedb10d058a0ea3c2d1d2b904516ef9b8efd950023dad5d62f6e03cd696625aecd6b024a21c336c4', 'complainant_email': 'c30d04070302ec373ca6cf1ec23372d23d01c564f373710551454c3689e482765215cb429d6e176d5a84a18b86f873c13a7d016d33db32b3a4ea9ff0f33ef3b57a0a28f8df0938254d761976479c', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 08:16:22,969 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:16:22,978 - db_manager - INFO - Starting database transaction
2025-09-09 08:16:22,978 - db_manager - INFO - Executing get_complainant_id_from_grievance_id: 
            SELECT complainant_id
            FROM grievances
            WHERE grievance_id = %s
 ...
2025-09-09 08:16:22,980 - db_manager - INFO - get_complainant_id_from_grievance_id completed in 0.01s. Rows: 1
2025-09-09 08:16:22,980 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:16:22,980 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:16:22,981 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-EAE2-B
2025-09-09 08:16:22,981 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {}
2025-09-09 08:16:22,981 - db_manager - DEBUG - encrypted_data at update_complainant: {}
2025-09-09 08:16:22,981 - db_manager - DEBUG - No complainant field to update
2025-09-09 08:16:22,981 - db_manager - INFO - Complainant updated in db: GR-20250909-KOJH-83DC-B
2025-09-09 08:16:22,981 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-83DC-B
2025-09-09 08:16:22,981 - db_manager - DEBUG - execute_update values: (['{"Environmental - Air Pollution"}'], 'GR-20250909-KOJH-83DC-B')
2025-09-09 08:16:22,981 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 08:16:22,981 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:16:22,988 - db_manager - INFO - Starting database transaction
2025-09-09 08:16:22,988 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance...
2025-09-09 08:16:22,990 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:16:22,992 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:16:22,992 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:16:22,993 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-83DC-B, rows affected: 1
2025-09-09 08:16:22,993 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-83DC-B
2025-09-09 08:28:47,278 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:28:47,279 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:28:47,279 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:28:47,279 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:28:47,279 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:28:47,279 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:28:47,279 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:28:47,280 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:28:47,280 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:28:47,280 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:28:47,280 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:28:47,280 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:28:47,280 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:28:47,280 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:28:47,280 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:28:47,280 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:28:47,280 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:28:47,280 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:28:47,280 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:28:47,280 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:28:47,280 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:28:47,280 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:28:47,280 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:28:47,280 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:28:47,280 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:28:47,281 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:28:47,281 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:28:47,281 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:28:47,281 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:28:47,281 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:29:57,997 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-0CA4-B
2025-09-09 08:29:57,998 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-0CA4-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-0CA4-B'}
2025-09-09 08:29:57,998 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 08:29:57,998 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 08:29:57,998 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 08:29:57,998 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 08:29:57,998 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:29:58,004 - db_manager - INFO - Starting database transaction
2025-09-09 08:29:58,007 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:29:58,007 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:29:58,007 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-0CA4-B
2025-09-09 08:29:58,007 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-D1B6-B', 'complainant_id': 'CM-20250909-KOJH-0CA4-B', 'grievance_description': 'duyst everywhere in the house', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-0CA4-B'}
2025-09-09 08:29:58,007 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-D1B6-B
2025-09-09 08:29:58,007 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 08:29:58,007 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 08:29:58,007 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 08:29:58,007 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 08:29:58,007 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:29:58,012 - db_manager - INFO - Starting database transaction
2025-09-09 08:29:58,016 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:29:58,016 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:29:58,016 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-D1B6-B
2025-09-09 08:30:27,042 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:30:27,048 - db_manager - INFO - Starting database transaction
2025-09-09 08:30:27,048 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 08:30:27,050 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 08:30:27,050 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:30:27,050 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:30:27,050 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:30:27,055 - db_manager - INFO - Starting database transaction
2025-09-09 08:30:27,055 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 08:30:27,057 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 08:30:27,057 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:30:27,057 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:30:27,057 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-D1B6-B', 'complainant_id': 'CM-20250909-KOJH-0CA4-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा सबैथोकमा धुलो छ', 'grievance_description': 'duyst everywhere in the house', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 29, 58, 13007, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 30, 2, 43674, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-D1B6-B', 'complainant_id': 'CM-20250909-KOJH-0CA4-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा सबैथोकमा धुलो छ', 'grievance_description': 'duyst everywhere in the house', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 29, 58, 13007, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 30, 2, 43674, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 08:30:27,058 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-0CA4-B
2025-09-09 08:30:27,058 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:30:27,063 - db_manager - INFO - Starting database transaction
2025-09-09 08:30:27,063 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:30:27,066 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:30:27,066 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:30:27,066 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:30:27,067 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d04070302f56a206ba16d8f547ed23d01d126f545057e9a97cfb6bc0a629628b69bdc506ddabdefe6ad02d8dae9d03a824fd5b72e7dcc8f452fb0e69bc3bb3eaa8d31deb7922d8f2adffc4cea
2025-09-09 08:30:27,067 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:30:27,072 - db_manager - INFO - Starting database transaction
2025-09-09 08:30:27,072 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:30:27,073 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:30:27,073 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:30:27,073 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:30:27,073 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:30:27,078 - db_manager - INFO - Starting database transaction
2025-09-09 08:30:27,078 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:30:27,079 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:30:27,079 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:30:27,079 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:30:27,079 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 08:30:27,079 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d0407030241f01bd12480fb927cd23d016b0556d07fba40a274efee77db4092785fef667fa8638b5f180c63dbe27474242325025d2780f1910293df9da6ea08738d44bd9ebd7a3f2718d9a6fc', 'complainant_phone': 'c30d04070302f56a206ba16d8f547ed23d01d126f545057e9a97cfb6bc0a629628b69bdc506ddabdefe6ad02d8dae9d03a824fd5b72e7dcc8f452fb0e69bc3bb3eaa8d31deb7922d8f2adffc4cea', 'complainant_email': 'c30d04070302ba048ffb4b60cc0166d23d01eea0db6965506bbeecc8489ffad86cc3990d9516f1f7d83c9b66d18c9fa8fd653d258f80fdf742b7427b2c73a37a6a9f91d40de71e39c7515a40c14e', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 08:30:27,079 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d0407030241f01bd12480fb927cd23d016b0556d07fba40a274efee77db4092785fef667fa8638b5f180c63dbe27474242325025d2780f1910293df9da6ea08738d44bd9ebd7a3f2718d9a6fc', 'complainant_phone': 'c30d04070302f56a206ba16d8f547ed23d01d126f545057e9a97cfb6bc0a629628b69bdc506ddabdefe6ad02d8dae9d03a824fd5b72e7dcc8f452fb0e69bc3bb3eaa8d31deb7922d8f2adffc4cea', 'complainant_email': 'c30d04070302ba048ffb4b60cc0166d23d01eea0db6965506bbeecc8489ffad86cc3990d9516f1f7d83c9b66d18c9fa8fd653d258f80fdf742b7427b2c73a37a6a9f91d40de71e39c7515a40c14e', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 08:30:27,079 - db_manager - DEBUG - execute_update values: ('c30d0407030241f01bd12480fb927cd23d016b0556d07fba40a274efee77db4092785fef667fa8638b5f180c63dbe27474242325025d2780f1910293df9da6ea08738d44bd9ebd7a3f2718d9a6fc', 'c30d04070302f56a206ba16d8f547ed23d01d126f545057e9a97cfb6bc0a629628b69bdc506ddabdefe6ad02d8dae9d03a824fd5b72e7dcc8f452fb0e69bc3bb3eaa8d31deb7922d8f2adffc4cea', 'c30d04070302ba048ffb4b60cc0166d23d01eea0db6965506bbeecc8489ffad86cc3990d9516f1f7d83c9b66d18c9fa8fd653d258f80fdf742b7427b2c73a37a6a9f91d40de71e39c7515a40c14e', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-0CA4-B')
2025-09-09 08:30:27,080 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_phone_hash = %s, complainant_email_hash = %s, complainant_full_name_hash = %s WHERE complainant_id = %s
2025-09-09 08:30:27,080 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:30:27,085 - db_manager - INFO - Starting database transaction
2025-09-09 08:30:27,085 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 08:30:27,086 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:30:27,088 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:30:27,088 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:30:27,088 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-0CA4-B
2025-09-09 08:30:27,088 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-D1B6-B
2025-09-09 08:30:27,088 - db_manager - DEBUG - execute_update values: ('duyst everywhere in the house', 'GR-20250909-KOJH-D1B6-B')
2025-09-09 08:30:27,088 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 08:30:27,088 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:30:27,093 - db_manager - INFO - Starting database transaction
2025-09-09 08:30:27,093 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 08:30:27,095 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:30:27,097 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:30:27,097 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:30:27,097 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-D1B6-B, rows affected: 1
2025-09-09 08:30:27,097 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-D1B6-B
2025-09-09 08:30:27,097 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:30:27,102 - db_manager - INFO - Starting database transaction
2025-09-09 08:30:27,102 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:30:27,103 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:30:27,104 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:30:27,104 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:30:27,104 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:30:27,108 - db_manager - INFO - Starting database transaction
2025-09-09 08:30:27,108 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:30:27,109 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:30:27,109 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:30:27,109 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:30:27,156 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:30:27,162 - db_manager - INFO - Starting database transaction
2025-09-09 08:30:27,163 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 08:30:27,164 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 08:30:27,165 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:30:27,165 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:30:27,165 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-D1B6-B', 'complainant_id': 'CM-20250909-KOJH-0CA4-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा सबैथोकमा धुलो छ', 'grievance_description': 'duyst everywhere in the house', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 29, 58, 13007, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 30, 27, 94052, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d0407030241f01bd12480fb927cd23d016b0556d07fba40a274efee77db4092785fef667fa8638b5f180c63dbe27474242325025d2780f1910293df9da6ea08738d44bd9ebd7a3f2718d9a6fc', 'complainant_phone': 'c30d04070302f56a206ba16d8f547ed23d01d126f545057e9a97cfb6bc0a629628b69bdc506ddabdefe6ad02d8dae9d03a824fd5b72e7dcc8f452fb0e69bc3bb3eaa8d31deb7922d8f2adffc4cea', 'complainant_email': 'c30d04070302ba048ffb4b60cc0166d23d01eea0db6965506bbeecc8489ffad86cc3990d9516f1f7d83c9b66d18c9fa8fd653d258f80fdf742b7427b2c73a37a6a9f91d40de71e39c7515a40c14e', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-D1B6-B', 'complainant_id': 'CM-20250909-KOJH-0CA4-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा सबैथोकमा धुलो छ', 'grievance_description': 'duyst everywhere in the house', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 29, 58, 13007, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 30, 27, 94052, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d0407030241f01bd12480fb927cd23d016b0556d07fba40a274efee77db4092785fef667fa8638b5f180c63dbe27474242325025d2780f1910293df9da6ea08738d44bd9ebd7a3f2718d9a6fc', 'complainant_phone': 'c30d04070302f56a206ba16d8f547ed23d01d126f545057e9a97cfb6bc0a629628b69bdc506ddabdefe6ad02d8dae9d03a824fd5b72e7dcc8f452fb0e69bc3bb3eaa8d31deb7922d8f2adffc4cea', 'complainant_email': 'c30d04070302ba048ffb4b60cc0166d23d01eea0db6965506bbeecc8489ffad86cc3990d9516f1f7d83c9b66d18c9fa8fd653d258f80fdf742b7427b2c73a37a6a9f91d40de71e39c7515a40c14e', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 08:30:31,538 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:30:31,543 - db_manager - INFO - Starting database transaction
2025-09-09 08:30:31,543 - db_manager - INFO - Executing get_complainant_id_from_grievance_id: 
            SELECT complainant_id
            FROM grievances
            WHERE grievance_id = %s
 ...
2025-09-09 08:30:31,545 - db_manager - INFO - get_complainant_id_from_grievance_id completed in 0.01s. Rows: 1
2025-09-09 08:30:31,545 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:30:31,545 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:30:31,545 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-0CA4-B
2025-09-09 08:30:31,545 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {}
2025-09-09 08:30:31,545 - db_manager - DEBUG - encrypted_data at update_complainant: {}
2025-09-09 08:30:31,545 - db_manager - DEBUG - No complainant field to update
2025-09-09 08:30:31,545 - db_manager - INFO - Complainant updated in db: GR-20250909-KOJH-D1B6-B
2025-09-09 08:30:31,545 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-D1B6-B
2025-09-09 08:30:31,545 - db_manager - DEBUG - execute_update values: (['{"Environmental - Air Pollution"}'], 'GR-20250909-KOJH-D1B6-B')
2025-09-09 08:30:31,545 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 08:30:31,545 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:30:31,550 - db_manager - INFO - Starting database transaction
2025-09-09 08:30:31,550 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance...
2025-09-09 08:30:31,552 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:30:31,555 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:30:31,555 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:30:31,555 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-D1B6-B, rows affected: 1
2025-09-09 08:30:31,555 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-D1B6-B
2025-09-09 08:32:59,389 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:32:59,389 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:32:59,389 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:32:59,389 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:32:59,389 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:32:59,389 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:32:59,390 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:32:59,390 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:32:59,390 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:32:59,390 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:32:59,390 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:32:59,390 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:32:59,390 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:32:59,390 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:32:59,390 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:32:59,390 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:32:59,390 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:32:59,390 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:32:59,390 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:32:59,390 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:32:59,390 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:32:59,390 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:32:59,390 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:32:59,390 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:32:59,390 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:32:59,390 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:32:59,390 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:32:59,390 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:32:59,391 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:32:59,391 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:37:04,637 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-5BAE-B
2025-09-09 08:37:04,637 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-5BAE-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-5BAE-B'}
2025-09-09 08:37:04,638 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 08:37:04,638 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 08:37:04,638 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 08:37:04,638 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 08:37:04,638 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:04,645 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:04,647 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:04,647 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:04,647 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-5BAE-B
2025-09-09 08:37:04,647 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-483F-B', 'complainant_id': 'CM-20250909-KOJH-5BAE-B', 'grievance_description': 'duyst everywhere in the house kids are sick', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-5BAE-B'}
2025-09-09 08:37:04,647 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-483F-B
2025-09-09 08:37:04,647 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 08:37:04,648 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 08:37:04,648 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 08:37:04,648 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 08:37:04,648 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:04,653 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:04,657 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:04,657 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:04,658 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-483F-B
2025-09-09 08:37:25,988 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:25,994 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:25,994 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 08:37:25,995 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 08:37:25,995 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:25,995 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:25,995 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:26,000 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:26,000 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 08:37:26,002 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 08:37:26,002 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:26,002 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:26,002 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-483F-B', 'complainant_id': 'CM-20250909-KOJH-5BAE-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा हरेक ठाउँमा धूलो छ, बालबालिका बिरामी छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 37, 4, 654034, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 37, 6, 53420, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-483F-B', 'complainant_id': 'CM-20250909-KOJH-5BAE-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा हरेक ठाउँमा धूलो छ, बालबालिका बिरामी छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 37, 4, 654034, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 37, 6, 53420, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 08:37:26,003 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-5BAE-B
2025-09-09 08:37:26,003 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:26,007 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:26,008 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:37:26,010 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:37:26,010 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:26,010 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:26,010 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d04070302db396d75b6d758cd6bd23d0185bdf5a37a613c5e3ac15fc5f5e19f489c93835d179ddf0c873126e8cdaac8f953c0438b10b39783478b954174aa2037418377db491c71bb54041113
2025-09-09 08:37:26,010 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:26,015 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:26,015 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:37:26,016 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:37:26,016 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:26,016 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:26,016 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:26,021 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:26,021 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:37:26,022 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:37:26,022 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:26,022 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:26,022 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 08:37:26,022 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d040703023e2c03e39778d09e6cd23d01e9cdd492a2d67a2afb650bc4487848f66b6e148df25305c421c792cc0aa61fa1ddd1acca2dec899722bd6e9203aceaa0d3132304e93e1b05f5150348', 'complainant_phone': 'c30d04070302db396d75b6d758cd6bd23d0185bdf5a37a613c5e3ac15fc5f5e19f489c93835d179ddf0c873126e8cdaac8f953c0438b10b39783478b954174aa2037418377db491c71bb54041113', 'complainant_email': 'c30d040703028a7f63f6ac75496d66d23d01cc9916b84ce3b98d0976c67fba32cb87d27605596b9fb9d682d30c78142139350e7be73e260940247f7deadc0ceb9147a271b730966e727042bb344c', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 08:37:26,022 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d040703023e2c03e39778d09e6cd23d01e9cdd492a2d67a2afb650bc4487848f66b6e148df25305c421c792cc0aa61fa1ddd1acca2dec899722bd6e9203aceaa0d3132304e93e1b05f5150348', 'complainant_phone': 'c30d04070302db396d75b6d758cd6bd23d0185bdf5a37a613c5e3ac15fc5f5e19f489c93835d179ddf0c873126e8cdaac8f953c0438b10b39783478b954174aa2037418377db491c71bb54041113', 'complainant_email': 'c30d040703028a7f63f6ac75496d66d23d01cc9916b84ce3b98d0976c67fba32cb87d27605596b9fb9d682d30c78142139350e7be73e260940247f7deadc0ceb9147a271b730966e727042bb344c', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 08:37:26,023 - db_manager - DEBUG - execute_update values: ('c30d040703023e2c03e39778d09e6cd23d01e9cdd492a2d67a2afb650bc4487848f66b6e148df25305c421c792cc0aa61fa1ddd1acca2dec899722bd6e9203aceaa0d3132304e93e1b05f5150348', 'c30d04070302db396d75b6d758cd6bd23d0185bdf5a37a613c5e3ac15fc5f5e19f489c93835d179ddf0c873126e8cdaac8f953c0438b10b39783478b954174aa2037418377db491c71bb54041113', 'c30d040703028a7f63f6ac75496d66d23d01cc9916b84ce3b98d0976c67fba32cb87d27605596b9fb9d682d30c78142139350e7be73e260940247f7deadc0ceb9147a271b730966e727042bb344c', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-5BAE-B')
2025-09-09 08:37:26,023 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_phone_hash = %s, complainant_full_name_hash = %s, complainant_email_hash = %s WHERE complainant_id = %s
2025-09-09 08:37:26,023 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:26,027 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:26,027 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 08:37:26,028 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:37:26,030 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:26,030 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:26,030 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-5BAE-B
2025-09-09 08:37:26,030 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-483F-B
2025-09-09 08:37:26,030 - db_manager - DEBUG - execute_update values: ('duyst everywhere in the house kids are sick', 'GR-20250909-KOJH-483F-B')
2025-09-09 08:37:26,030 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 08:37:26,030 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:26,035 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:26,035 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 08:37:26,036 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:37:26,039 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:26,039 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:26,039 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-483F-B, rows affected: 1
2025-09-09 08:37:26,039 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-483F-B
2025-09-09 08:37:26,039 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:26,044 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:26,044 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:37:26,045 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:37:26,045 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:26,045 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:26,045 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:26,050 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:26,050 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:37:26,051 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:37:26,051 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:26,051 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:26,096 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:26,102 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:26,103 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 08:37:26,104 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 08:37:26,105 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:26,105 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:26,105 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-483F-B', 'complainant_id': 'CM-20250909-KOJH-5BAE-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा हरेक ठाउँमा धूलो छ, बालबालिका बिरामी छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 37, 4, 654034, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 37, 26, 35714, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d040703023e2c03e39778d09e6cd23d01e9cdd492a2d67a2afb650bc4487848f66b6e148df25305c421c792cc0aa61fa1ddd1acca2dec899722bd6e9203aceaa0d3132304e93e1b05f5150348', 'complainant_phone': 'c30d04070302db396d75b6d758cd6bd23d0185bdf5a37a613c5e3ac15fc5f5e19f489c93835d179ddf0c873126e8cdaac8f953c0438b10b39783478b954174aa2037418377db491c71bb54041113', 'complainant_email': 'c30d040703028a7f63f6ac75496d66d23d01cc9916b84ce3b98d0976c67fba32cb87d27605596b9fb9d682d30c78142139350e7be73e260940247f7deadc0ceb9147a271b730966e727042bb344c', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-483F-B', 'complainant_id': 'CM-20250909-KOJH-5BAE-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा हरेक ठाउँमा धूलो छ, बालबालिका बिरामी छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 37, 4, 654034, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 37, 26, 35714, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d040703023e2c03e39778d09e6cd23d01e9cdd492a2d67a2afb650bc4487848f66b6e148df25305c421c792cc0aa61fa1ddd1acca2dec899722bd6e9203aceaa0d3132304e93e1b05f5150348', 'complainant_phone': 'c30d04070302db396d75b6d758cd6bd23d0185bdf5a37a613c5e3ac15fc5f5e19f489c93835d179ddf0c873126e8cdaac8f953c0438b10b39783478b954174aa2037418377db491c71bb54041113', 'complainant_email': 'c30d040703028a7f63f6ac75496d66d23d01cc9916b84ce3b98d0976c67fba32cb87d27605596b9fb9d682d30c78142139350e7be73e260940247f7deadc0ceb9147a271b730966e727042bb344c', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 08:37:28,604 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:28,610 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:28,611 - db_manager - INFO - Executing get_complainant_id_from_grievance_id: 
            SELECT complainant_id
            FROM grievances
            WHERE grievance_id = %s
 ...
2025-09-09 08:37:28,612 - db_manager - INFO - get_complainant_id_from_grievance_id completed in 0.01s. Rows: 1
2025-09-09 08:37:28,612 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:28,612 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:28,612 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-5BAE-B
2025-09-09 08:37:28,612 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {}
2025-09-09 08:37:28,612 - db_manager - DEBUG - encrypted_data at update_complainant: {}
2025-09-09 08:37:28,612 - db_manager - DEBUG - No complainant field to update
2025-09-09 08:37:28,612 - db_manager - INFO - Complainant updated in db: GR-20250909-KOJH-483F-B
2025-09-09 08:37:28,613 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-483F-B
2025-09-09 08:37:28,613 - db_manager - DEBUG - execute_update values: (['{"Environmental - Air Pollution"}'], 'GR-20250909-KOJH-483F-B')
2025-09-09 08:37:28,613 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 08:37:28,613 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:37:28,618 - db_manager - INFO - Starting database transaction
2025-09-09 08:37:28,618 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance...
2025-09-09 08:37:28,620 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:37:28,622 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:37:28,622 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:37:28,623 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-483F-B, rows affected: 1
2025-09-09 08:37:28,623 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-483F-B
2025-09-09 08:38:53,371 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:38:53,371 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:38:53,371 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:38:53,371 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:38:53,371 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:38:53,371 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:38:53,372 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:38:53,372 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:38:53,372 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:38:53,372 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:38:53,372 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:38:53,372 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:38:53,372 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:38:53,372 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:38:53,372 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:38:53,372 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:38:53,372 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:38:53,372 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:38:53,372 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:38:53,372 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:38:53,372 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:38:53,372 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:38:53,372 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:38:53,372 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:38:53,372 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:38:53,372 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:38:53,372 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:38:53,372 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:38:53,372 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:38:53,372 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:39:46,534 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-8A1D-B
2025-09-09 08:39:46,535 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-8A1D-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-8A1D-B'}
2025-09-09 08:39:46,535 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 08:39:46,535 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 08:39:46,535 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 08:39:46,535 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 08:39:46,535 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:39:46,542 - db_manager - INFO - Starting database transaction
2025-09-09 08:39:46,544 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:39:46,544 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:39:46,544 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-8A1D-B
2025-09-09 08:39:46,544 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-7503-B', 'complainant_id': 'CM-20250909-KOJH-8A1D-B', 'grievance_description': 'duyst everywhere in the house kids are sick', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-8A1D-B'}
2025-09-09 08:39:46,544 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-7503-B
2025-09-09 08:39:46,544 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 08:39:46,544 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 08:39:46,545 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 08:39:46,545 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 08:39:46,545 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:39:46,550 - db_manager - INFO - Starting database transaction
2025-09-09 08:39:46,554 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:39:46,554 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:39:46,555 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-7503-B
2025-09-09 08:40:16,812 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:16,818 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:16,818 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 08:40:16,819 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 08:40:16,819 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:16,819 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:40:16,819 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:16,824 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:16,824 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 08:40:16,826 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 08:40:16,826 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:16,826 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:40:16,826 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-7503-B', 'complainant_id': 'CM-20250909-KOJH-8A1D-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'धुलो सबैथोकमा छ, बच्चाहरु बिरामी छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 39, 46, 551087, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 39, 50, 560492, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-7503-B', 'complainant_id': 'CM-20250909-KOJH-8A1D-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'धुलो सबैथोकमा छ, बच्चाहरु बिरामी छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 39, 46, 551087, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 39, 50, 560492, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 08:40:16,826 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-8A1D-B
2025-09-09 08:40:16,826 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:16,831 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:16,831 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:40:16,832 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:40:16,832 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:16,833 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:40:16,833 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d040703022e94c2739482592867d23d010da9c448239d4509a700ec60d641f039d3b0f8dc2c91034688e0d798079eb8118d8477b42eca58ad67474be2344a18f9e6ee39fb178feefd44294dd6
2025-09-09 08:40:16,833 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:16,838 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:16,838 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:40:16,839 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:40:16,840 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:16,840 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:40:16,840 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:16,845 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:16,845 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:40:16,846 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:40:16,846 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:16,846 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:40:16,846 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 08:40:16,846 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d04070302f3231f91f957f39c6cd23d01dde54c8fdeee2d824794b20b7e52fadc8f496594b3a58421015bb0b1b85e7097c9a400dcef9445fea52d0749fbcc81d137b03cb0209d54524103b518', 'complainant_phone': 'c30d040703022e94c2739482592867d23d010da9c448239d4509a700ec60d641f039d3b0f8dc2c91034688e0d798079eb8118d8477b42eca58ad67474be2344a18f9e6ee39fb178feefd44294dd6', 'complainant_email': 'c30d04070302619550108deadd2375d23d013c91750787ff933ce0f96d7b1dfb50a92ed1a6d5ac8e86eabaf776e06b74103fc3a2fa62fad870f109a432db40db1b73a0b051cf1f2caf6bfaa147fb', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 08:40:16,846 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d04070302f3231f91f957f39c6cd23d01dde54c8fdeee2d824794b20b7e52fadc8f496594b3a58421015bb0b1b85e7097c9a400dcef9445fea52d0749fbcc81d137b03cb0209d54524103b518', 'complainant_phone': 'c30d040703022e94c2739482592867d23d010da9c448239d4509a700ec60d641f039d3b0f8dc2c91034688e0d798079eb8118d8477b42eca58ad67474be2344a18f9e6ee39fb178feefd44294dd6', 'complainant_email': 'c30d04070302619550108deadd2375d23d013c91750787ff933ce0f96d7b1dfb50a92ed1a6d5ac8e86eabaf776e06b74103fc3a2fa62fad870f109a432db40db1b73a0b051cf1f2caf6bfaa147fb', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 08:40:16,847 - db_manager - DEBUG - execute_update values: ('c30d04070302f3231f91f957f39c6cd23d01dde54c8fdeee2d824794b20b7e52fadc8f496594b3a58421015bb0b1b85e7097c9a400dcef9445fea52d0749fbcc81d137b03cb0209d54524103b518', 'c30d040703022e94c2739482592867d23d010da9c448239d4509a700ec60d641f039d3b0f8dc2c91034688e0d798079eb8118d8477b42eca58ad67474be2344a18f9e6ee39fb178feefd44294dd6', 'c30d04070302619550108deadd2375d23d013c91750787ff933ce0f96d7b1dfb50a92ed1a6d5ac8e86eabaf776e06b74103fc3a2fa62fad870f109a432db40db1b73a0b051cf1f2caf6bfaa147fb', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-8A1D-B')
2025-09-09 08:40:16,847 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_phone_hash = %s, complainant_full_name_hash = %s, complainant_email_hash = %s WHERE complainant_id = %s
2025-09-09 08:40:16,847 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:16,851 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:16,852 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 08:40:16,853 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:40:16,855 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:16,855 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:40:16,855 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-8A1D-B
2025-09-09 08:40:16,856 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-7503-B
2025-09-09 08:40:16,856 - db_manager - DEBUG - execute_update values: ('duyst everywhere in the house kids are sick', 'GR-20250909-KOJH-7503-B')
2025-09-09 08:40:16,856 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 08:40:16,856 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:16,860 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:16,860 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 08:40:16,861 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:40:16,863 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:16,863 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:40:16,863 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-7503-B, rows affected: 1
2025-09-09 08:40:16,863 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-7503-B
2025-09-09 08:40:16,863 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:16,869 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:16,869 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:40:16,870 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:40:16,871 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:16,871 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:40:16,871 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:16,876 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:16,876 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:40:16,877 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:40:16,877 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:16,878 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:40:16,924 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:16,929 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:16,929 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 08:40:16,932 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 08:40:16,932 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:16,932 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:40:16,932 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-7503-B', 'complainant_id': 'CM-20250909-KOJH-8A1D-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'धुलो सबैथोकमा छ, बच्चाहरु बिरामी छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 39, 46, 551087, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 40, 16, 860929, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d04070302f3231f91f957f39c6cd23d01dde54c8fdeee2d824794b20b7e52fadc8f496594b3a58421015bb0b1b85e7097c9a400dcef9445fea52d0749fbcc81d137b03cb0209d54524103b518', 'complainant_phone': 'c30d040703022e94c2739482592867d23d010da9c448239d4509a700ec60d641f039d3b0f8dc2c91034688e0d798079eb8118d8477b42eca58ad67474be2344a18f9e6ee39fb178feefd44294dd6', 'complainant_email': 'c30d04070302619550108deadd2375d23d013c91750787ff933ce0f96d7b1dfb50a92ed1a6d5ac8e86eabaf776e06b74103fc3a2fa62fad870f109a432db40db1b73a0b051cf1f2caf6bfaa147fb', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-7503-B', 'complainant_id': 'CM-20250909-KOJH-8A1D-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'धुलो सबैथोकमा छ, बच्चाहरु बिरामी छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 39, 46, 551087, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 40, 16, 860929, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d04070302f3231f91f957f39c6cd23d01dde54c8fdeee2d824794b20b7e52fadc8f496594b3a58421015bb0b1b85e7097c9a400dcef9445fea52d0749fbcc81d137b03cb0209d54524103b518', 'complainant_phone': 'c30d040703022e94c2739482592867d23d010da9c448239d4509a700ec60d641f039d3b0f8dc2c91034688e0d798079eb8118d8477b42eca58ad67474be2344a18f9e6ee39fb178feefd44294dd6', 'complainant_email': 'c30d04070302619550108deadd2375d23d013c91750787ff933ce0f96d7b1dfb50a92ed1a6d5ac8e86eabaf776e06b74103fc3a2fa62fad870f109a432db40db1b73a0b051cf1f2caf6bfaa147fb', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 08:40:20,427 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:20,432 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:20,432 - db_manager - INFO - Executing get_complainant_id_from_grievance_id: 
            SELECT complainant_id
            FROM grievances
            WHERE grievance_id = %s
 ...
2025-09-09 08:40:20,433 - db_manager - INFO - get_complainant_id_from_grievance_id completed in 0.01s. Rows: 1
2025-09-09 08:40:20,434 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:20,434 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:40:20,434 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-8A1D-B
2025-09-09 08:40:20,434 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {}
2025-09-09 08:40:20,434 - db_manager - DEBUG - encrypted_data at update_complainant: {}
2025-09-09 08:40:20,434 - db_manager - DEBUG - No complainant field to update
2025-09-09 08:40:20,434 - db_manager - INFO - Complainant updated in db: GR-20250909-KOJH-7503-B
2025-09-09 08:40:20,434 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-7503-B
2025-09-09 08:40:20,434 - db_manager - DEBUG - execute_update values: (['{"Environmental - Air Pollution"}'], 'GR-20250909-KOJH-7503-B')
2025-09-09 08:40:20,434 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 08:40:20,434 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:20,439 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:20,439 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance...
2025-09-09 08:40:20,440 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:40:20,443 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:20,443 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:40:20,443 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-7503-B, rows affected: 1
2025-09-09 08:40:20,443 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-7503-B
2025-09-09 08:40:20,488 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:40:20,494 - db_manager - INFO - Starting database transaction
2025-09-09 08:40:20,494 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:40:20,496 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:40:20,496 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:40:20,496 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:46:11,829 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:46:11,830 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:46:11,830 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:46:11,830 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:46:11,830 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:46:11,830 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:46:11,831 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:46:11,831 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:46:11,831 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:46:11,831 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:46:11,831 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:46:11,831 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:46:11,831 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:46:11,831 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:46:11,831 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:46:11,831 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:46:11,831 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:46:11,831 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:46:11,831 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:46:11,832 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:46:11,832 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:46:11,832 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:46:11,832 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:46:11,832 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:46:11,832 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:46:11,832 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:46:11,832 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:46:11,832 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:46:11,832 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:46:11,832 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:47:18,963 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-2EC9-B
2025-09-09 08:47:18,963 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-2EC9-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-2EC9-B'}
2025-09-09 08:47:18,963 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 08:47:18,963 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 08:47:18,963 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 08:47:18,963 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 08:47:18,964 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:18,970 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:18,974 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:18,974 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:18,975 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-2EC9-B
2025-09-09 08:47:18,975 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-8EE1-B', 'complainant_id': 'CM-20250909-KOJH-2EC9-B', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-2EC9-B'}
2025-09-09 08:47:18,975 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-8EE1-B
2025-09-09 08:47:18,975 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 08:47:18,975 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 08:47:18,975 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 08:47:18,975 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 08:47:18,975 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:18,981 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:18,986 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:18,987 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:18,987 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-8EE1-B
2025-09-09 08:47:42,251 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:42,257 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:42,257 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 08:47:42,259 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 08:47:42,259 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:42,259 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:42,259 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:42,265 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:42,265 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 08:47:42,267 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 08:47:42,267 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:42,267 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:42,267 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-8EE1-B', 'complainant_id': 'CM-20250909-KOJH-2EC9-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा हरेक ठाउँमा धुलो रहेको छ, विरामी पनि भएका छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 47, 18, 981878, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 47, 23, 60580, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-8EE1-B', 'complainant_id': 'CM-20250909-KOJH-2EC9-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा हरेक ठाउँमा धुलो रहेको छ, विरामी पनि भएका छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 47, 18, 981878, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 47, 23, 60580, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 08:47:42,267 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-2EC9-B
2025-09-09 08:47:42,267 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:42,272 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:42,272 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:47:42,276 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:47:42,276 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:42,276 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:42,276 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:42,282 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:42,282 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:47:42,283 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:47:42,284 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:42,284 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:42,284 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d04070302ba9235dfb02f56377ed23d012a397a986a0294bcc2a4ded08cd262ca7595e28435a7d143d5fa23a8267db4093e6e44fd9b26929c6b729829ba6585cc82c2b8e150b816345e33dac2
2025-09-09 08:47:42,284 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:42,289 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:42,290 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:47:42,291 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:47:42,291 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:42,291 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:42,291 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 08:47:42,291 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d04070302f4dd1bc952b0db056dd23d01baa11652ca147fc38c58193ad1ae1e66e515655731fb4959d810dc9adcfabfd081b0956ab20e5650076932c485ab287680548bd090d3ccc990549d6e', 'complainant_phone': 'c30d04070302ba9235dfb02f56377ed23d012a397a986a0294bcc2a4ded08cd262ca7595e28435a7d143d5fa23a8267db4093e6e44fd9b26929c6b729829ba6585cc82c2b8e150b816345e33dac2', 'complainant_email': 'c30d04070302f5857df0409ec4206cd23d01980681ff0baa7fefc2c36f189873c4dd7249edcec0004b67d3ecd72e23643a9ccf7c8e19cc60fe7ab6f9e050bcfdfe91b0a49867373df00bf9fcfef3', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 08:47:42,292 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d04070302f4dd1bc952b0db056dd23d01baa11652ca147fc38c58193ad1ae1e66e515655731fb4959d810dc9adcfabfd081b0956ab20e5650076932c485ab287680548bd090d3ccc990549d6e', 'complainant_phone': 'c30d04070302ba9235dfb02f56377ed23d012a397a986a0294bcc2a4ded08cd262ca7595e28435a7d143d5fa23a8267db4093e6e44fd9b26929c6b729829ba6585cc82c2b8e150b816345e33dac2', 'complainant_email': 'c30d04070302f5857df0409ec4206cd23d01980681ff0baa7fefc2c36f189873c4dd7249edcec0004b67d3ecd72e23643a9ccf7c8e19cc60fe7ab6f9e050bcfdfe91b0a49867373df00bf9fcfef3', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 08:47:42,292 - db_manager - DEBUG - execute_update values: ('c30d04070302f4dd1bc952b0db056dd23d01baa11652ca147fc38c58193ad1ae1e66e515655731fb4959d810dc9adcfabfd081b0956ab20e5650076932c485ab287680548bd090d3ccc990549d6e', 'c30d04070302ba9235dfb02f56377ed23d012a397a986a0294bcc2a4ded08cd262ca7595e28435a7d143d5fa23a8267db4093e6e44fd9b26929c6b729829ba6585cc82c2b8e150b816345e33dac2', 'c30d04070302f5857df0409ec4206cd23d01980681ff0baa7fefc2c36f189873c4dd7249edcec0004b67d3ecd72e23643a9ccf7c8e19cc60fe7ab6f9e050bcfdfe91b0a49867373df00bf9fcfef3', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-2EC9-B')
2025-09-09 08:47:42,292 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_email_hash = %s, complainant_phone_hash = %s, complainant_full_name_hash = %s WHERE complainant_id = %s
2025-09-09 08:47:42,292 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:42,297 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:42,297 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 08:47:42,298 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:47:42,300 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:42,301 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:42,301 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-2EC9-B
2025-09-09 08:47:42,301 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-8EE1-B
2025-09-09 08:47:42,301 - db_manager - DEBUG - execute_update values: ('duyst everywhere in the house kids are sick"', 'GR-20250909-KOJH-8EE1-B')
2025-09-09 08:47:42,301 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 08:47:42,301 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:42,306 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:42,306 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 08:47:42,308 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:47:42,310 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:42,310 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:42,310 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-8EE1-B, rows affected: 1
2025-09-09 08:47:42,310 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-8EE1-B
2025-09-09 08:47:42,311 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:42,316 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:42,317 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:47:42,318 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:47:42,318 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:42,318 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:42,318 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:42,324 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:42,324 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:47:42,325 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:47:42,325 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:42,325 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:42,371 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:42,376 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:42,377 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 08:47:42,378 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 08:47:42,379 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:42,379 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:42,379 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-8EE1-B', 'complainant_id': 'CM-20250909-KOJH-2EC9-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा हरेक ठाउँमा धुलो रहेको छ, विरामी पनि भएका छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 47, 18, 981878, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 47, 42, 307042, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d04070302f4dd1bc952b0db056dd23d01baa11652ca147fc38c58193ad1ae1e66e515655731fb4959d810dc9adcfabfd081b0956ab20e5650076932c485ab287680548bd090d3ccc990549d6e', 'complainant_phone': 'c30d04070302ba9235dfb02f56377ed23d012a397a986a0294bcc2a4ded08cd262ca7595e28435a7d143d5fa23a8267db4093e6e44fd9b26929c6b729829ba6585cc82c2b8e150b816345e33dac2', 'complainant_email': 'c30d04070302f5857df0409ec4206cd23d01980681ff0baa7fefc2c36f189873c4dd7249edcec0004b67d3ecd72e23643a9ccf7c8e19cc60fe7ab6f9e050bcfdfe91b0a49867373df00bf9fcfef3', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-8EE1-B', 'complainant_id': 'CM-20250909-KOJH-2EC9-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा हरेक ठाउँमा धुलो रहेको छ, विरामी पनि भएका छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 47, 18, 981878, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 47, 42, 307042, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d04070302f4dd1bc952b0db056dd23d01baa11652ca147fc38c58193ad1ae1e66e515655731fb4959d810dc9adcfabfd081b0956ab20e5650076932c485ab287680548bd090d3ccc990549d6e', 'complainant_phone': 'c30d04070302ba9235dfb02f56377ed23d012a397a986a0294bcc2a4ded08cd262ca7595e28435a7d143d5fa23a8267db4093e6e44fd9b26929c6b729829ba6585cc82c2b8e150b816345e33dac2', 'complainant_email': 'c30d04070302f5857df0409ec4206cd23d01980681ff0baa7fefc2c36f189873c4dd7249edcec0004b67d3ecd72e23643a9ccf7c8e19cc60fe7ab6f9e050bcfdfe91b0a49867373df00bf9fcfef3', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 08:47:46,607 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:46,613 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:46,613 - db_manager - INFO - Executing get_complainant_id_from_grievance_id: 
            SELECT complainant_id
            FROM grievances
            WHERE grievance_id = %s
 ...
2025-09-09 08:47:46,614 - db_manager - INFO - get_complainant_id_from_grievance_id completed in 0.01s. Rows: 1
2025-09-09 08:47:46,614 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:46,614 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:46,615 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-2EC9-B
2025-09-09 08:47:46,615 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {}
2025-09-09 08:47:46,615 - db_manager - DEBUG - encrypted_data at update_complainant: {}
2025-09-09 08:47:46,615 - db_manager - DEBUG - No complainant field to update
2025-09-09 08:47:46,615 - db_manager - INFO - Complainant updated in db: GR-20250909-KOJH-8EE1-B
2025-09-09 08:47:46,615 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-8EE1-B
2025-09-09 08:47:46,615 - db_manager - DEBUG - execute_update values: (['{"Environmental - Air Pollution"}'], 'GR-20250909-KOJH-8EE1-B')
2025-09-09 08:47:46,615 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 08:47:46,615 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:47:46,620 - db_manager - INFO - Starting database transaction
2025-09-09 08:47:46,620 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance...
2025-09-09 08:47:46,621 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:47:46,624 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:47:46,624 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:47:46,624 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-8EE1-B, rows affected: 1
2025-09-09 08:47:46,624 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-8EE1-B
2025-09-09 08:50:27,566 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:50:27,567 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:50:27,567 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:50:27,567 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:50:27,567 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:50:27,567 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:50:27,567 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:50:27,567 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:50:27,567 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:50:27,568 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:50:27,568 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:50:27,568 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:50:27,568 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:50:27,568 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:50:27,568 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:50:27,568 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:50:27,568 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:50:27,568 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:50:27,568 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:50:27,568 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:50:27,568 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:50:27,568 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:50:27,568 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:50:27,568 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:50:27,568 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:50:27,568 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:50:27,568 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:50:27,568 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:50:27,568 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:50:27,568 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:57:22,483 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:57:22,483 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:57:22,483 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:57:22,484 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:57:22,484 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:57:22,484 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:57:22,484 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:57:22,484 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:57:22,484 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:57:22,484 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:57:22,484 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:57:22,484 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:57:22,484 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:57:22,484 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:57:22,484 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:57:22,484 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:57:22,484 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:57:22,484 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:57:22,484 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:57:22,484 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:57:22,484 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:57:22,484 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:57:22,484 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:57:22,485 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:57:22,485 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:57:22,485 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:57:22,485 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:57:22,485 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 08:57:22,485 - db_manager - INFO - Database manager initialized successfully
2025-09-09 08:57:22,485 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 08:58:46,226 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-D8FC-B
2025-09-09 08:58:46,226 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-D8FC-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-D8FC-B'}
2025-09-09 08:58:46,226 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 08:58:46,226 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 08:58:46,226 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 08:58:46,226 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 08:58:46,226 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:58:46,233 - db_manager - INFO - Starting database transaction
2025-09-09 08:58:46,235 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:58:46,235 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:58:46,236 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-D8FC-B
2025-09-09 08:58:46,236 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-11E6-B', 'complainant_id': 'CM-20250909-KOJH-D8FC-B', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-D8FC-B'}
2025-09-09 08:58:46,236 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-11E6-B
2025-09-09 08:58:46,236 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 08:58:46,236 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 08:58:46,236 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 08:58:46,236 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 08:58:46,236 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:58:46,241 - db_manager - INFO - Starting database transaction
2025-09-09 08:58:46,252 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:58:46,252 - db_manager - INFO - Database connection closed. Duration: 0.02s
2025-09-09 08:58:46,253 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-11E6-B
2025-09-09 08:59:01,421 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:01,427 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:01,427 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 08:59:01,428 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 08:59:01,429 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:01,429 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:59:01,429 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:01,435 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:01,435 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 08:59:01,437 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 08:59:01,437 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:01,437 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:59:01,438 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-11E6-B', 'complainant_id': 'CM-20250909-KOJH-D8FC-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा सर्वत्र धुलो, बालबालिकाहरू बिरामी', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 58, 46, 242020, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 58, 50, 323980, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-11E6-B', 'complainant_id': 'CM-20250909-KOJH-D8FC-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा सर्वत्र धुलो, बालबालिकाहरू बिरामी', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 58, 46, 242020, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 58, 50, 323980, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 08:59:01,438 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-D8FC-B
2025-09-09 08:59:01,438 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:01,444 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:01,444 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:59:01,447 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:59:01,447 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:01,447 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:59:01,447 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d040703024499c183da1cabc879d23d018af903078769efe1b37afe73379258b852557e17f027c3b117f0b36b5c7f30ebd831b6e2422b20f13e2251c07575be8a4ee982cffaf09ead633ffa4d
2025-09-09 08:59:01,447 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:01,452 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:01,452 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:59:01,453 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:59:01,453 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:01,454 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:59:01,454 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:01,459 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:01,460 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 08:59:01,461 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 08:59:01,461 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:01,461 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:59:01,461 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 08:59:01,461 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d04070302623e6d6a82d4c6d06fd23d0133d432119e67ef7e10f659fb535675b3dcfc96111f2e2935968065bb898b61fe5b93285cbc406ddd9ed609d25e0c96c3780deb12d4209c937e75fb0f', 'complainant_phone': 'c30d040703024499c183da1cabc879d23d018af903078769efe1b37afe73379258b852557e17f027c3b117f0b36b5c7f30ebd831b6e2422b20f13e2251c07575be8a4ee982cffaf09ead633ffa4d', 'complainant_email': 'c30d0407030296c1638fa714649063d23d01ef04464739002e7427a2c3bdf83fa93dc16d5e172681348cc1128129c8d23c3b5d594d16a3bcc6dd7302d4560fd1088c28361934633faf6320e88bbb', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 08:59:01,461 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d04070302623e6d6a82d4c6d06fd23d0133d432119e67ef7e10f659fb535675b3dcfc96111f2e2935968065bb898b61fe5b93285cbc406ddd9ed609d25e0c96c3780deb12d4209c937e75fb0f', 'complainant_phone': 'c30d040703024499c183da1cabc879d23d018af903078769efe1b37afe73379258b852557e17f027c3b117f0b36b5c7f30ebd831b6e2422b20f13e2251c07575be8a4ee982cffaf09ead633ffa4d', 'complainant_email': 'c30d0407030296c1638fa714649063d23d01ef04464739002e7427a2c3bdf83fa93dc16d5e172681348cc1128129c8d23c3b5d594d16a3bcc6dd7302d4560fd1088c28361934633faf6320e88bbb', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 08:59:01,461 - db_manager - DEBUG - execute_update values: ('c30d04070302623e6d6a82d4c6d06fd23d0133d432119e67ef7e10f659fb535675b3dcfc96111f2e2935968065bb898b61fe5b93285cbc406ddd9ed609d25e0c96c3780deb12d4209c937e75fb0f', 'c30d040703024499c183da1cabc879d23d018af903078769efe1b37afe73379258b852557e17f027c3b117f0b36b5c7f30ebd831b6e2422b20f13e2251c07575be8a4ee982cffaf09ead633ffa4d', 'c30d0407030296c1638fa714649063d23d01ef04464739002e7427a2c3bdf83fa93dc16d5e172681348cc1128129c8d23c3b5d594d16a3bcc6dd7302d4560fd1088c28361934633faf6320e88bbb', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-D8FC-B')
2025-09-09 08:59:01,461 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_phone_hash = %s, complainant_full_name_hash = %s, complainant_email_hash = %s WHERE complainant_id = %s
2025-09-09 08:59:01,461 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:01,467 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:01,467 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 08:59:01,469 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:59:01,471 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:01,471 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:59:01,471 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-D8FC-B
2025-09-09 08:59:01,471 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-11E6-B
2025-09-09 08:59:01,471 - db_manager - DEBUG - execute_update values: ('duyst everywhere in the house kids are sick"', 'GR-20250909-KOJH-11E6-B')
2025-09-09 08:59:01,471 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 08:59:01,471 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:01,477 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:01,477 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 08:59:01,478 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:59:01,480 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:01,481 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:59:01,481 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-11E6-B, rows affected: 1
2025-09-09 08:59:01,481 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-11E6-B
2025-09-09 08:59:01,481 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:01,486 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:01,486 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:59:01,487 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:59:01,487 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:01,487 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:59:01,488 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:01,493 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:01,493 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:59:01,495 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:59:01,495 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:01,495 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:59:01,544 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:01,551 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:01,551 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 08:59:01,553 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 08:59:01,553 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:01,553 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:59:01,554 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-11E6-B', 'complainant_id': 'CM-20250909-KOJH-D8FC-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा सर्वत्र धुलो, बालबालिकाहरू बिरामी', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 58, 46, 242020, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 59, 1, 477630, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d04070302623e6d6a82d4c6d06fd23d0133d432119e67ef7e10f659fb535675b3dcfc96111f2e2935968065bb898b61fe5b93285cbc406ddd9ed609d25e0c96c3780deb12d4209c937e75fb0f', 'complainant_phone': 'c30d040703024499c183da1cabc879d23d018af903078769efe1b37afe73379258b852557e17f027c3b117f0b36b5c7f30ebd831b6e2422b20f13e2251c07575be8a4ee982cffaf09ead633ffa4d', 'complainant_email': 'c30d0407030296c1638fa714649063d23d01ef04464739002e7427a2c3bdf83fa93dc16d5e172681348cc1128129c8d23c3b5d594d16a3bcc6dd7302d4560fd1088c28361934633faf6320e88bbb', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-11E6-B', 'complainant_id': 'CM-20250909-KOJH-D8FC-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा सर्वत्र धुलो, बालबालिकाहरू बिरामी', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 8, 58, 46, 242020, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 8, 59, 1, 477630, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d04070302623e6d6a82d4c6d06fd23d0133d432119e67ef7e10f659fb535675b3dcfc96111f2e2935968065bb898b61fe5b93285cbc406ddd9ed609d25e0c96c3780deb12d4209c937e75fb0f', 'complainant_phone': 'c30d040703024499c183da1cabc879d23d018af903078769efe1b37afe73379258b852557e17f027c3b117f0b36b5c7f30ebd831b6e2422b20f13e2251c07575be8a4ee982cffaf09ead633ffa4d', 'complainant_email': 'c30d0407030296c1638fa714649063d23d01ef04464739002e7427a2c3bdf83fa93dc16d5e172681348cc1128129c8d23c3b5d594d16a3bcc6dd7302d4560fd1088c28361934633faf6320e88bbb', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 08:59:04,225 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:04,234 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:04,234 - db_manager - INFO - Executing get_complainant_id_from_grievance_id: 
            SELECT complainant_id
            FROM grievances
            WHERE grievance_id = %s
 ...
2025-09-09 08:59:04,236 - db_manager - INFO - get_complainant_id_from_grievance_id completed in 0.01s. Rows: 1
2025-09-09 08:59:04,236 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:04,237 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:59:04,237 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-D8FC-B
2025-09-09 08:59:04,237 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {}
2025-09-09 08:59:04,238 - db_manager - DEBUG - encrypted_data at update_complainant: {}
2025-09-09 08:59:04,238 - db_manager - DEBUG - No complainant field to update
2025-09-09 08:59:04,238 - db_manager - INFO - Complainant updated in db: GR-20250909-KOJH-11E6-B
2025-09-09 08:59:04,238 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-11E6-B
2025-09-09 08:59:04,238 - db_manager - DEBUG - execute_update values: (['{"Environmental - Air Pollution"}'], 'GR-20250909-KOJH-11E6-B')
2025-09-09 08:59:04,238 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 08:59:04,238 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:04,247 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:04,247 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance...
2025-09-09 08:59:04,249 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 08:59:04,252 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:04,252 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 08:59:04,252 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-11E6-B, rows affected: 1
2025-09-09 08:59:04,252 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-11E6-B
2025-09-09 08:59:04,304 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 08:59:04,310 - db_manager - INFO - Starting database transaction
2025-09-09 08:59:04,310 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 08:59:04,312 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 08:59:04,312 - db_manager - INFO - Transaction committed successfully
2025-09-09 08:59:04,312 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:01:31,848 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:01:31,849 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:01:31,849 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:01:31,849 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:01:31,850 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:01:31,850 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:01:31,850 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:01:31,850 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:01:31,850 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:01:31,850 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:01:31,850 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:01:31,850 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:01:31,850 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:01:31,850 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:01:31,850 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:01:31,850 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:01:31,850 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:01:31,850 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:01:31,850 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:01:31,851 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:01:31,851 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:01:31,851 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:01:31,851 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:01:31,851 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:01:31,851 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:01:31,851 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:01:31,851 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:01:31,851 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:01:31,851 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:01:31,851 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:02:05,242 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-6EF6-B
2025-09-09 09:02:05,242 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-6EF6-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-6EF6-B'}
2025-09-09 09:02:05,242 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 09:02:05,242 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 09:02:05,242 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 09:02:05,243 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 09:02:05,243 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:05,250 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:05,253 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:05,254 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:05,254 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-6EF6-B
2025-09-09 09:02:05,254 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-01C9-B', 'complainant_id': 'CM-20250909-KOJH-6EF6-B', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-6EF6-B'}
2025-09-09 09:02:05,254 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-01C9-B
2025-09-09 09:02:05,254 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 09:02:05,254 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 09:02:05,254 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 09:02:05,254 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 09:02:05,254 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:05,260 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:05,264 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:05,265 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:05,265 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-01C9-B
2025-09-09 09:02:30,489 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:30,495 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:30,495 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 09:02:30,496 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 09:02:30,496 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:30,496 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:30,496 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:30,502 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:30,502 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 09:02:30,503 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 09:02:30,504 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:30,504 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:30,504 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-01C9-B', 'complainant_id': 'CM-20250909-KOJH-6EF6-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा सधैं धूलो छ, बच्चाहरु बिरामी भएका छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 2, 5, 260570, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 2, 9, 336646, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-01C9-B', 'complainant_id': 'CM-20250909-KOJH-6EF6-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा सधैं धूलो छ, बच्चाहरु बिरामी भएका छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 2, 5, 260570, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 2, 9, 336646, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 09:02:30,504 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-6EF6-B
2025-09-09 09:02:30,504 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:30,510 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:30,510 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 09:02:30,513 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 09:02:30,513 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:30,513 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:30,513 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d04070302ea8e344e7b59798b7fd23d01084c4d316965fef5df7783436d451b1e116f3bfc63ce1ee9fc552da4f070c1c222314d0a537b2341dadbba318a5f7ef86e013dff247a79d5da366b63
2025-09-09 09:02:30,513 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:30,519 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:30,519 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 09:02:30,520 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 09:02:30,520 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:30,520 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:30,520 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:30,525 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:30,525 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 09:02:30,526 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 09:02:30,526 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:30,527 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:30,527 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 09:02:30,527 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d04070302eb440c4c17ac476860d23d017471b40be6ab1443d1260cfd99b96a920156802848bd940893746fb8fa343a15bd1ac64d6e9897917cb88ea2d383758d95c8d19a0d06692594bb108c', 'complainant_phone': 'c30d04070302ea8e344e7b59798b7fd23d01084c4d316965fef5df7783436d451b1e116f3bfc63ce1ee9fc552da4f070c1c222314d0a537b2341dadbba318a5f7ef86e013dff247a79d5da366b63', 'complainant_email': 'c30d04070302fbb4f2a3df4464ab7bd23d01ecdef0b718b2d337eaf3910f713dd90e0266592b33fbf6fecc7f3fa07351b5cf2750a13a748f61788e41eca79dd073e6cb3743befc170b713aef7dcf', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 09:02:30,527 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d04070302eb440c4c17ac476860d23d017471b40be6ab1443d1260cfd99b96a920156802848bd940893746fb8fa343a15bd1ac64d6e9897917cb88ea2d383758d95c8d19a0d06692594bb108c', 'complainant_phone': 'c30d04070302ea8e344e7b59798b7fd23d01084c4d316965fef5df7783436d451b1e116f3bfc63ce1ee9fc552da4f070c1c222314d0a537b2341dadbba318a5f7ef86e013dff247a79d5da366b63', 'complainant_email': 'c30d04070302fbb4f2a3df4464ab7bd23d01ecdef0b718b2d337eaf3910f713dd90e0266592b33fbf6fecc7f3fa07351b5cf2750a13a748f61788e41eca79dd073e6cb3743befc170b713aef7dcf', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 09:02:30,527 - db_manager - DEBUG - execute_update values: ('c30d04070302eb440c4c17ac476860d23d017471b40be6ab1443d1260cfd99b96a920156802848bd940893746fb8fa343a15bd1ac64d6e9897917cb88ea2d383758d95c8d19a0d06692594bb108c', 'c30d04070302ea8e344e7b59798b7fd23d01084c4d316965fef5df7783436d451b1e116f3bfc63ce1ee9fc552da4f070c1c222314d0a537b2341dadbba318a5f7ef86e013dff247a79d5da366b63', 'c30d04070302fbb4f2a3df4464ab7bd23d01ecdef0b718b2d337eaf3910f713dd90e0266592b33fbf6fecc7f3fa07351b5cf2750a13a748f61788e41eca79dd073e6cb3743befc170b713aef7dcf', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-6EF6-B')
2025-09-09 09:02:30,527 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_phone_hash = %s, complainant_full_name_hash = %s, complainant_email_hash = %s WHERE complainant_id = %s
2025-09-09 09:02:30,527 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:30,532 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:30,532 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 09:02:30,533 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 09:02:30,535 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:30,535 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:30,535 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-6EF6-B
2025-09-09 09:02:30,535 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-01C9-B
2025-09-09 09:02:30,535 - db_manager - DEBUG - execute_update values: ('duyst everywhere in the house kids are sick"', 'GR-20250909-KOJH-01C9-B')
2025-09-09 09:02:30,535 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 09:02:30,535 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:30,540 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:30,540 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 09:02:30,541 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 09:02:30,544 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:30,544 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:30,544 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-01C9-B, rows affected: 1
2025-09-09 09:02:30,544 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-01C9-B
2025-09-09 09:02:30,544 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:30,549 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:30,550 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 09:02:30,551 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 09:02:30,551 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:30,551 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:30,551 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:30,557 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:30,557 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 09:02:30,558 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 09:02:30,558 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:30,558 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:30,609 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:30,615 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:30,615 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 09:02:30,617 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 09:02:30,617 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:30,618 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:30,618 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-01C9-B', 'complainant_id': 'CM-20250909-KOJH-6EF6-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा सधैं धूलो छ, बच्चाहरु बिरामी भएका छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 2, 5, 260570, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 2, 30, 540901, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d04070302eb440c4c17ac476860d23d017471b40be6ab1443d1260cfd99b96a920156802848bd940893746fb8fa343a15bd1ac64d6e9897917cb88ea2d383758d95c8d19a0d06692594bb108c', 'complainant_phone': 'c30d04070302ea8e344e7b59798b7fd23d01084c4d316965fef5df7783436d451b1e116f3bfc63ce1ee9fc552da4f070c1c222314d0a537b2341dadbba318a5f7ef86e013dff247a79d5da366b63', 'complainant_email': 'c30d04070302fbb4f2a3df4464ab7bd23d01ecdef0b718b2d337eaf3910f713dd90e0266592b33fbf6fecc7f3fa07351b5cf2750a13a748f61788e41eca79dd073e6cb3743befc170b713aef7dcf', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-01C9-B', 'complainant_id': 'CM-20250909-KOJH-6EF6-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा सधैं धूलो छ, बच्चाहरु बिरामी भएका छन्।', 'grievance_description': 'duyst everywhere in the house kids are sick"', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 2, 5, 260570, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 2, 30, 540901, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d04070302eb440c4c17ac476860d23d017471b40be6ab1443d1260cfd99b96a920156802848bd940893746fb8fa343a15bd1ac64d6e9897917cb88ea2d383758d95c8d19a0d06692594bb108c', 'complainant_phone': 'c30d04070302ea8e344e7b59798b7fd23d01084c4d316965fef5df7783436d451b1e116f3bfc63ce1ee9fc552da4f070c1c222314d0a537b2341dadbba318a5f7ef86e013dff247a79d5da366b63', 'complainant_email': 'c30d04070302fbb4f2a3df4464ab7bd23d01ecdef0b718b2d337eaf3910f713dd90e0266592b33fbf6fecc7f3fa07351b5cf2750a13a748f61788e41eca79dd073e6cb3743befc170b713aef7dcf', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 09:02:32,701 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:32,706 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:32,707 - db_manager - INFO - Executing get_complainant_id_from_grievance_id: 
            SELECT complainant_id
            FROM grievances
            WHERE grievance_id = %s
 ...
2025-09-09 09:02:32,708 - db_manager - INFO - get_complainant_id_from_grievance_id completed in 0.01s. Rows: 1
2025-09-09 09:02:32,708 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:32,708 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:32,708 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-6EF6-B
2025-09-09 09:02:32,708 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {}
2025-09-09 09:02:32,708 - db_manager - DEBUG - encrypted_data at update_complainant: {}
2025-09-09 09:02:32,708 - db_manager - DEBUG - No complainant field to update
2025-09-09 09:02:32,709 - db_manager - INFO - Complainant updated in db: GR-20250909-KOJH-01C9-B
2025-09-09 09:02:32,709 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-01C9-B
2025-09-09 09:02:32,709 - db_manager - DEBUG - execute_update values: (['{"Environmental - Air Pollution"}'], 'GR-20250909-KOJH-01C9-B')
2025-09-09 09:02:32,709 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 09:02:32,709 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:32,714 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:32,714 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance...
2025-09-09 09:02:32,715 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 09:02:32,717 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:32,718 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:02:32,718 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-01C9-B, rows affected: 1
2025-09-09 09:02:32,718 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-01C9-B
2025-09-09 09:02:32,764 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:02:32,769 - db_manager - INFO - Starting database transaction
2025-09-09 09:02:32,769 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 09:02:32,771 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 09:02:32,771 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:02:32,771 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:05:09,211 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:05:09,211 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:05:09,211 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:05:09,211 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:05:09,212 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:05:09,212 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:05:09,212 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:05:09,212 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:05:09,212 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:05:09,212 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:05:09,212 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:05:09,212 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:05:09,212 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:05:09,212 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:05:09,212 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:05:09,212 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:05:09,213 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:05:09,213 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:05:09,213 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:05:09,213 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:05:09,213 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:05:09,213 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:05:09,213 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:05:09,213 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:05:09,213 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:05:09,213 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:05:09,213 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:05:09,213 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:05:09,213 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:05:09,213 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:06:16,104 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-2592-B
2025-09-09 09:06:16,104 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-2592-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-2592-B'}
2025-09-09 09:06:16,104 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 09:06:16,104 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 09:06:16,104 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 09:06:16,104 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 09:06:16,104 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:16,111 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:16,114 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:16,114 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:16,114 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-2592-B
2025-09-09 09:06:16,114 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-2F5B-B', 'complainant_id': 'CM-20250909-KOJH-2592-B', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-2592-B'}
2025-09-09 09:06:16,114 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-2F5B-B
2025-09-09 09:06:16,114 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 09:06:16,114 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 09:06:16,114 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 09:06:16,115 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 09:06:16,115 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:16,120 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:16,124 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:16,124 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:16,124 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-2F5B-B
2025-09-09 09:06:37,926 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:37,932 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:37,933 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 09:06:37,934 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 09:06:37,934 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:37,934 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:37,934 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:37,939 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:37,939 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 09:06:37,941 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 09:06:37,941 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:37,941 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:37,941 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-2F5B-B', 'complainant_id': 'CM-20250909-KOJH-2592-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा हरेक ठाउँमा धुलो, बच्चाहरू बिरामी, अस्पताल जानु पर्छ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 6, 16, 120517, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 6, 22, 725667, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-2F5B-B', 'complainant_id': 'CM-20250909-KOJH-2592-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा हरेक ठाउँमा धुलो, बच्चाहरू बिरामी, अस्पताल जानु पर्छ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 6, 16, 120517, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 6, 22, 725667, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 09:06:37,942 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-2592-B
2025-09-09 09:06:37,942 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:37,946 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:37,946 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 09:06:37,948 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 09:06:37,948 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:37,948 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:37,948 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:37,953 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:37,953 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 09:06:37,954 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 09:06:37,954 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:37,954 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:37,955 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:37,960 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:37,960 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 09:06:37,961 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 09:06:37,961 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:37,961 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:37,961 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d0407030247f20939c111902c60d23d01b98dee9a5693e9807a79f87daa35df02b6990865e3c09132f6067ddfc92cf42ad8a2cb33af31f451d6fdf26757d1d147604e62532e5c99588302db8d
2025-09-09 09:06:37,961 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 09:06:37,961 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d04070302476c77628ecd40c87cd23d01d8a52fb0e1d8c56a4c3d3781bab0713e75db0ddd109ed4df111503ae21b8b530df1c966953adf7752054db57a9f7eef88081b6ad91a0c34e930b645d', 'complainant_phone': 'c30d0407030247f20939c111902c60d23d01b98dee9a5693e9807a79f87daa35df02b6990865e3c09132f6067ddfc92cf42ad8a2cb33af31f451d6fdf26757d1d147604e62532e5c99588302db8d', 'complainant_email': 'c30d04070302a44480284016ebc571d23d01cedc802801aebd7044c4130f0eaf786f0df37cf06f5897166aba677f3b02ccf3b16a570fcc60d916c2f74d63b5c97eee148704b170373b4bf401dde0', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 09:06:37,961 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d04070302476c77628ecd40c87cd23d01d8a52fb0e1d8c56a4c3d3781bab0713e75db0ddd109ed4df111503ae21b8b530df1c966953adf7752054db57a9f7eef88081b6ad91a0c34e930b645d', 'complainant_phone': 'c30d0407030247f20939c111902c60d23d01b98dee9a5693e9807a79f87daa35df02b6990865e3c09132f6067ddfc92cf42ad8a2cb33af31f451d6fdf26757d1d147604e62532e5c99588302db8d', 'complainant_email': 'c30d04070302a44480284016ebc571d23d01cedc802801aebd7044c4130f0eaf786f0df37cf06f5897166aba677f3b02ccf3b16a570fcc60d916c2f74d63b5c97eee148704b170373b4bf401dde0', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 09:06:37,961 - db_manager - DEBUG - execute_update values: ('c30d04070302476c77628ecd40c87cd23d01d8a52fb0e1d8c56a4c3d3781bab0713e75db0ddd109ed4df111503ae21b8b530df1c966953adf7752054db57a9f7eef88081b6ad91a0c34e930b645d', 'c30d0407030247f20939c111902c60d23d01b98dee9a5693e9807a79f87daa35df02b6990865e3c09132f6067ddfc92cf42ad8a2cb33af31f451d6fdf26757d1d147604e62532e5c99588302db8d', 'c30d04070302a44480284016ebc571d23d01cedc802801aebd7044c4130f0eaf786f0df37cf06f5897166aba677f3b02ccf3b16a570fcc60d916c2f74d63b5c97eee148704b170373b4bf401dde0', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-2592-B')
2025-09-09 09:06:37,961 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_full_name_hash = %s, complainant_email_hash = %s, complainant_phone_hash = %s WHERE complainant_id = %s
2025-09-09 09:06:37,961 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:37,966 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:37,966 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 09:06:37,967 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 09:06:37,970 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:37,970 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:37,970 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-2592-B
2025-09-09 09:06:37,970 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-2F5B-B
2025-09-09 09:06:37,970 - db_manager - DEBUG - execute_update values: ('dust everywhere in the house, the kids are sick, I need to go to the hospital', 'GR-20250909-KOJH-2F5B-B')
2025-09-09 09:06:37,970 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 09:06:37,970 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:37,975 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:37,975 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 09:06:37,977 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 09:06:37,979 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:37,979 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:37,979 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-2F5B-B, rows affected: 1
2025-09-09 09:06:37,979 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-2F5B-B
2025-09-09 09:06:37,979 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:37,984 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:37,984 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 09:06:37,985 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 09:06:37,986 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:37,986 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:37,986 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:37,990 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:37,991 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 09:06:37,992 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 09:06:37,992 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:37,992 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:38,039 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:38,045 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:38,045 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 09:06:38,047 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 09:06:38,047 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:38,047 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:38,047 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-2F5B-B', 'complainant_id': 'CM-20250909-KOJH-2592-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा हरेक ठाउँमा धुलो, बच्चाहरू बिरामी, अस्पताल जानु पर्छ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 6, 16, 120517, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 6, 37, 975974, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d04070302476c77628ecd40c87cd23d01d8a52fb0e1d8c56a4c3d3781bab0713e75db0ddd109ed4df111503ae21b8b530df1c966953adf7752054db57a9f7eef88081b6ad91a0c34e930b645d', 'complainant_phone': 'c30d0407030247f20939c111902c60d23d01b98dee9a5693e9807a79f87daa35df02b6990865e3c09132f6067ddfc92cf42ad8a2cb33af31f451d6fdf26757d1d147604e62532e5c99588302db8d', 'complainant_email': 'c30d04070302a44480284016ebc571d23d01cedc802801aebd7044c4130f0eaf786f0df37cf06f5897166aba677f3b02ccf3b16a570fcc60d916c2f74d63b5c97eee148704b170373b4bf401dde0', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-2F5B-B', 'complainant_id': 'CM-20250909-KOJH-2592-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा हरेक ठाउँमा धुलो, बच्चाहरू बिरामी, अस्पताल जानु पर्छ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 6, 16, 120517, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 6, 37, 975974, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d04070302476c77628ecd40c87cd23d01d8a52fb0e1d8c56a4c3d3781bab0713e75db0ddd109ed4df111503ae21b8b530df1c966953adf7752054db57a9f7eef88081b6ad91a0c34e930b645d', 'complainant_phone': 'c30d0407030247f20939c111902c60d23d01b98dee9a5693e9807a79f87daa35df02b6990865e3c09132f6067ddfc92cf42ad8a2cb33af31f451d6fdf26757d1d147604e62532e5c99588302db8d', 'complainant_email': 'c30d04070302a44480284016ebc571d23d01cedc802801aebd7044c4130f0eaf786f0df37cf06f5897166aba677f3b02ccf3b16a570fcc60d916c2f74d63b5c97eee148704b170373b4bf401dde0', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 09:06:40,386 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:40,393 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:40,394 - db_manager - INFO - Executing get_complainant_id_from_grievance_id: 
            SELECT complainant_id
            FROM grievances
            WHERE grievance_id = %s
 ...
2025-09-09 09:06:40,395 - db_manager - INFO - get_complainant_id_from_grievance_id completed in 0.01s. Rows: 1
2025-09-09 09:06:40,395 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:40,395 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:40,396 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-2592-B
2025-09-09 09:06:40,396 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {}
2025-09-09 09:06:40,396 - db_manager - DEBUG - encrypted_data at update_complainant: {}
2025-09-09 09:06:40,396 - db_manager - DEBUG - No complainant field to update
2025-09-09 09:06:40,396 - db_manager - INFO - Complainant updated in db: GR-20250909-KOJH-2F5B-B
2025-09-09 09:06:40,396 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-2F5B-B
2025-09-09 09:06:40,396 - db_manager - DEBUG - execute_update values: (['{"Environmental - Air Pollution"}'], 'GR-20250909-KOJH-2F5B-B')
2025-09-09 09:06:40,396 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 09:06:40,396 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:40,404 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:40,404 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance...
2025-09-09 09:06:40,406 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 09:06:40,409 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:40,409 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:06:40,409 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-2F5B-B, rows affected: 1
2025-09-09 09:06:40,409 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-2F5B-B
2025-09-09 09:06:40,459 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:06:40,465 - db_manager - INFO - Starting database transaction
2025-09-09 09:06:40,465 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 09:06:40,467 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 09:06:40,467 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:06:40,467 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:15:12,373 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-BE29-B
2025-09-09 09:15:12,373 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-BE29-B', 'complainant_province': None, 'complainant_district': None, 'complainant_unique_id': 'CM-20250909-KOJH-BE29-B'}
2025-09-09 09:15:12,373 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 09:15:12,374 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 09:15:12,374 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 09:15:12,374 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 09:15:12,374 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:15:12,379 - db_manager - INFO - Starting database transaction
2025-09-09 09:15:12,382 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:15:12,382 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:15:12,382 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-BE29-B
2025-09-09 09:15:12,382 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-707F-B', 'complainant_id': 'CM-20250909-KOJH-BE29-B', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'complainant_province': None, 'complainant_district': None, 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-BE29-B'}
2025-09-09 09:15:12,382 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-707F-B
2025-09-09 09:15:12,382 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 09:15:12,382 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 09:15:12,382 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 09:15:12,382 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 09:15:12,382 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:15:12,387 - db_manager - INFO - Starting database transaction
2025-09-09 09:15:12,393 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:15:12,393 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:15:12,393 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-707F-B
2025-09-09 09:38:03,625 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:38:03,626 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:38:03,626 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:38:03,627 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:38:03,627 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:38:03,627 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:38:03,627 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:38:03,627 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:38:03,627 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:38:03,627 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:38:03,627 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:38:03,627 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:38:03,627 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:38:03,627 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:38:03,627 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:38:03,627 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:38:03,627 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:38:03,627 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:38:03,627 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:38:03,627 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:38:03,627 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:38:03,628 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:38:03,628 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:38:03,628 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:38:03,628 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:38:03,628 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:38:03,628 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:38:03,628 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 09:38:03,628 - db_manager - INFO - Database manager initialized successfully
2025-09-09 09:38:03,628 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 09:39:01,647 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-90FC-B
2025-09-09 09:39:01,647 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-90FC-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-90FC-B'}
2025-09-09 09:39:01,647 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 09:39:01,647 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 09:39:01,647 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 09:39:01,647 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 09:39:01,647 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:01,653 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:01,656 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:01,656 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:01,656 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-90FC-B
2025-09-09 09:39:01,656 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-6A36-B', 'complainant_id': 'CM-20250909-KOJH-90FC-B', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-90FC-B'}
2025-09-09 09:39:01,656 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-6A36-B
2025-09-09 09:39:01,656 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 09:39:01,656 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 09:39:01,656 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 09:39:01,656 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 09:39:01,656 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:01,661 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:01,668 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:01,668 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:01,668 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-6A36-B
2025-09-09 09:39:26,154 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:26,160 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:26,160 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 09:39:26,161 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 09:39:26,161 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:26,161 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:26,162 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:26,166 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:26,166 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 09:39:26,168 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 09:39:26,169 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:26,169 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:26,169 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-6A36-B', 'complainant_id': 'CM-20250909-KOJH-90FC-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धुलो सबै ठाउमा छ, बच्चाहरु बिरामी छन्, मलाई अस्पताल जानु पर्दछ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 39, 1, 662234, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 39, 11, 803577, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-6A36-B', 'complainant_id': 'CM-20250909-KOJH-90FC-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धुलो सबै ठाउमा छ, बच्चाहरु बिरामी छन्, मलाई अस्पताल जानु पर्दछ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 39, 1, 662234, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 39, 11, 803577, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 09:39:26,169 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-90FC-B
2025-09-09 09:39:26,169 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:26,175 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:26,175 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 09:39:26,178 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 09:39:26,178 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:26,178 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:26,178 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:26,183 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:26,183 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 09:39:26,184 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 09:39:26,184 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:26,184 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:26,185 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:26,190 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:26,190 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 09:39:26,191 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 09:39:26,191 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:26,191 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:26,192 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d04070302763744277d72c80275d23d01ffd28da72d0ed52489a795a210118bc09bf698a910d812763b7f434fe0e9427389eef8d2110691df4c942eb8f0d10b0e578f68d2d2aeed0c0fb75ab5
2025-09-09 09:39:26,192 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 09:39:26,192 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d04070302bd70f817fe15939365d23d0110d101bdf17a7a5e87fea2a950c27ad9daae5e277b4cd51be0c5cad5c82c4c4db7034bddfc6afbacbbc9c7ae5e26588d6cf19f6c0c2c6b4ce69d623b', 'complainant_phone': 'c30d04070302763744277d72c80275d23d01ffd28da72d0ed52489a795a210118bc09bf698a910d812763b7f434fe0e9427389eef8d2110691df4c942eb8f0d10b0e578f68d2d2aeed0c0fb75ab5', 'complainant_email': 'c30d04070302f06a091e48280b0362d23d01c886d58c33cd2f06c028d91e9e218ee251fba59f4275ec54ca808a29a95d6295eab62bd93da7409ecbfef844b4aea3d0e288eb2d7793ac07e11704e1', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 09:39:26,192 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d04070302bd70f817fe15939365d23d0110d101bdf17a7a5e87fea2a950c27ad9daae5e277b4cd51be0c5cad5c82c4c4db7034bddfc6afbacbbc9c7ae5e26588d6cf19f6c0c2c6b4ce69d623b', 'complainant_phone': 'c30d04070302763744277d72c80275d23d01ffd28da72d0ed52489a795a210118bc09bf698a910d812763b7f434fe0e9427389eef8d2110691df4c942eb8f0d10b0e578f68d2d2aeed0c0fb75ab5', 'complainant_email': 'c30d04070302f06a091e48280b0362d23d01c886d58c33cd2f06c028d91e9e218ee251fba59f4275ec54ca808a29a95d6295eab62bd93da7409ecbfef844b4aea3d0e288eb2d7793ac07e11704e1', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 09:39:26,192 - db_manager - DEBUG - execute_update values: ('c30d04070302bd70f817fe15939365d23d0110d101bdf17a7a5e87fea2a950c27ad9daae5e277b4cd51be0c5cad5c82c4c4db7034bddfc6afbacbbc9c7ae5e26588d6cf19f6c0c2c6b4ce69d623b', 'c30d04070302763744277d72c80275d23d01ffd28da72d0ed52489a795a210118bc09bf698a910d812763b7f434fe0e9427389eef8d2110691df4c942eb8f0d10b0e578f68d2d2aeed0c0fb75ab5', 'c30d04070302f06a091e48280b0362d23d01c886d58c33cd2f06c028d91e9e218ee251fba59f4275ec54ca808a29a95d6295eab62bd93da7409ecbfef844b4aea3d0e288eb2d7793ac07e11704e1', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-90FC-B')
2025-09-09 09:39:26,192 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_full_name_hash = %s, complainant_email_hash = %s, complainant_phone_hash = %s WHERE complainant_id = %s
2025-09-09 09:39:26,192 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:26,197 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:26,198 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 09:39:26,199 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 09:39:26,201 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:26,201 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:26,201 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-90FC-B
2025-09-09 09:39:26,201 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-6A36-B
2025-09-09 09:39:26,201 - db_manager - DEBUG - execute_update values: ('dust everywhere in the house, the kids are sick, I need to go to the hospital', 'GR-20250909-KOJH-6A36-B')
2025-09-09 09:39:26,201 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 09:39:26,201 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:26,207 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:26,207 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 09:39:26,209 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 09:39:26,211 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:26,211 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:26,211 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-6A36-B, rows affected: 1
2025-09-09 09:39:26,211 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-6A36-B
2025-09-09 09:39:26,211 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:26,217 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:26,217 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 09:39:26,218 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 09:39:26,218 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:26,218 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:26,218 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:26,224 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:26,224 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 09:39:26,226 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 09:39:26,226 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:26,226 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:26,274 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:26,281 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:26,281 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 09:39:26,283 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 09:39:26,283 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:26,284 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:26,284 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-6A36-B', 'complainant_id': 'CM-20250909-KOJH-90FC-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धुलो सबै ठाउमा छ, बच्चाहरु बिरामी छन्, मलाई अस्पताल जानु पर्दछ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 39, 1, 662234, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 39, 26, 207914, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d04070302bd70f817fe15939365d23d0110d101bdf17a7a5e87fea2a950c27ad9daae5e277b4cd51be0c5cad5c82c4c4db7034bddfc6afbacbbc9c7ae5e26588d6cf19f6c0c2c6b4ce69d623b', 'complainant_phone': 'c30d04070302763744277d72c80275d23d01ffd28da72d0ed52489a795a210118bc09bf698a910d812763b7f434fe0e9427389eef8d2110691df4c942eb8f0d10b0e578f68d2d2aeed0c0fb75ab5', 'complainant_email': 'c30d04070302f06a091e48280b0362d23d01c886d58c33cd2f06c028d91e9e218ee251fba59f4275ec54ca808a29a95d6295eab62bd93da7409ecbfef844b4aea3d0e288eb2d7793ac07e11704e1', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-6A36-B', 'complainant_id': 'CM-20250909-KOJH-90FC-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धुलो सबै ठाउमा छ, बच्चाहरु बिरामी छन्, मलाई अस्पताल जानु पर्दछ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 39, 1, 662234, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 39, 26, 207914, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d04070302bd70f817fe15939365d23d0110d101bdf17a7a5e87fea2a950c27ad9daae5e277b4cd51be0c5cad5c82c4c4db7034bddfc6afbacbbc9c7ae5e26588d6cf19f6c0c2c6b4ce69d623b', 'complainant_phone': 'c30d04070302763744277d72c80275d23d01ffd28da72d0ed52489a795a210118bc09bf698a910d812763b7f434fe0e9427389eef8d2110691df4c942eb8f0d10b0e578f68d2d2aeed0c0fb75ab5', 'complainant_email': 'c30d04070302f06a091e48280b0362d23d01c886d58c33cd2f06c028d91e9e218ee251fba59f4275ec54ca808a29a95d6295eab62bd93da7409ecbfef844b4aea3d0e288eb2d7793ac07e11704e1', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 09:39:29,287 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:29,293 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:29,293 - db_manager - INFO - Executing get_complainant_id_from_grievance_id: 
            SELECT complainant_id
            FROM grievances
            WHERE grievance_id = %s
 ...
2025-09-09 09:39:29,295 - db_manager - INFO - get_complainant_id_from_grievance_id completed in 0.01s. Rows: 1
2025-09-09 09:39:29,295 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:29,295 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:29,295 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-90FC-B
2025-09-09 09:39:29,295 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {}
2025-09-09 09:39:29,295 - db_manager - DEBUG - encrypted_data at update_complainant: {}
2025-09-09 09:39:29,295 - db_manager - DEBUG - No complainant field to update
2025-09-09 09:39:29,295 - db_manager - INFO - Complainant updated in db: GR-20250909-KOJH-6A36-B
2025-09-09 09:39:29,295 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-6A36-B
2025-09-09 09:39:29,295 - db_manager - DEBUG - execute_update values: (['{"Environmental - Air Pollution"}'], 'GR-20250909-KOJH-6A36-B')
2025-09-09 09:39:29,295 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 09:39:29,295 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:29,301 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:29,302 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance...
2025-09-09 09:39:29,303 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 09:39:29,306 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:29,306 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:39:29,306 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-6A36-B, rows affected: 1
2025-09-09 09:39:29,306 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-6A36-B
2025-09-09 09:39:29,355 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:39:29,361 - db_manager - INFO - Starting database transaction
2025-09-09 09:39:29,361 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 09:39:29,363 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 09:39:29,363 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:39:29,363 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:03,123 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-FB83-B
2025-09-09 09:40:03,123 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-FB83-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-FB83-B'}
2025-09-09 09:40:03,123 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 09:40:03,123 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 09:40:03,123 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 09:40:03,123 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 09:40:03,123 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:03,130 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:03,133 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:03,133 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:03,133 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-FB83-B
2025-09-09 09:40:03,133 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-7D5C-B', 'complainant_id': 'CM-20250909-KOJH-FB83-B', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-FB83-B'}
2025-09-09 09:40:03,133 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-7D5C-B
2025-09-09 09:40:03,133 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 09:40:03,133 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 09:40:03,133 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 09:40:03,133 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 09:40:03,134 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:03,139 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:03,144 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:03,144 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:03,144 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-7D5C-B
2025-09-09 09:40:14,862 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:14,868 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:14,868 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 09:40:14,870 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 09:40:14,870 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:14,870 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:14,871 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:14,876 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:14,876 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 09:40:14,878 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 09:40:14,878 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:14,878 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:14,879 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-7D5C-B', 'complainant_id': 'CM-20250909-KOJH-FB83-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धूलो सबै ठाउँमा, बच्चाहरू बिरामी छन्, मलाई अस्पताल जान आवश्यक छ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 40, 3, 140094, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 40, 7, 759691, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-7D5C-B', 'complainant_id': 'CM-20250909-KOJH-FB83-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धूलो सबै ठाउँमा, बच्चाहरू बिरामी छन्, मलाई अस्पताल जान आवश्यक छ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 40, 3, 140094, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 40, 7, 759691, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 09:40:14,879 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-FB83-B
2025-09-09 09:40:14,879 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:14,885 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:14,885 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 09:40:14,889 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 09:40:14,889 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:14,889 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:14,889 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:14,895 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:14,895 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 09:40:14,896 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 09:40:14,897 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:14,897 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:14,897 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:14,902 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:14,902 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 09:40:14,904 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 09:40:14,904 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:14,904 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:14,905 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d04070302fd6a9ac969b9ece46dd23d01062a7730fad3fb38fca124353d437d5574b11891beca3238d2581cf32debc8d0ad9ef5f2ac657e3a0cc1f1b9e98904b887acd584add77a71afdb0a64
2025-09-09 09:40:14,905 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 09:40:14,905 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d040703022059845d2d7a182475d23d01119e48339d7a62985c331da23b068222d80ea42c8dc900a38e51f15a62ca03e989a3b590b4bd964c1eaa64d0bbf0d0c57a2d66de8a95b108915b0157', 'complainant_phone': 'c30d04070302fd6a9ac969b9ece46dd23d01062a7730fad3fb38fca124353d437d5574b11891beca3238d2581cf32debc8d0ad9ef5f2ac657e3a0cc1f1b9e98904b887acd584add77a71afdb0a64', 'complainant_email': 'c30d0407030271c3760d230a94fd7dd23d01e146bc692306bfffc8ec293602257850e3b0676ad76b0cb2a9bb52184c7ab8f76cb6ec04b7726359bc8b314807988dedd90243cd48e111dc023c5bf5', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 09:40:14,905 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d040703022059845d2d7a182475d23d01119e48339d7a62985c331da23b068222d80ea42c8dc900a38e51f15a62ca03e989a3b590b4bd964c1eaa64d0bbf0d0c57a2d66de8a95b108915b0157', 'complainant_phone': 'c30d04070302fd6a9ac969b9ece46dd23d01062a7730fad3fb38fca124353d437d5574b11891beca3238d2581cf32debc8d0ad9ef5f2ac657e3a0cc1f1b9e98904b887acd584add77a71afdb0a64', 'complainant_email': 'c30d0407030271c3760d230a94fd7dd23d01e146bc692306bfffc8ec293602257850e3b0676ad76b0cb2a9bb52184c7ab8f76cb6ec04b7726359bc8b314807988dedd90243cd48e111dc023c5bf5', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 09:40:14,905 - db_manager - DEBUG - execute_update values: ('c30d040703022059845d2d7a182475d23d01119e48339d7a62985c331da23b068222d80ea42c8dc900a38e51f15a62ca03e989a3b590b4bd964c1eaa64d0bbf0d0c57a2d66de8a95b108915b0157', 'c30d04070302fd6a9ac969b9ece46dd23d01062a7730fad3fb38fca124353d437d5574b11891beca3238d2581cf32debc8d0ad9ef5f2ac657e3a0cc1f1b9e98904b887acd584add77a71afdb0a64', 'c30d0407030271c3760d230a94fd7dd23d01e146bc692306bfffc8ec293602257850e3b0676ad76b0cb2a9bb52184c7ab8f76cb6ec04b7726359bc8b314807988dedd90243cd48e111dc023c5bf5', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-FB83-B')
2025-09-09 09:40:14,905 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_full_name_hash = %s, complainant_email_hash = %s, complainant_phone_hash = %s WHERE complainant_id = %s
2025-09-09 09:40:14,905 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:14,910 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:14,910 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 09:40:14,911 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 09:40:14,913 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:14,913 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:14,913 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-FB83-B
2025-09-09 09:40:14,913 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-7D5C-B
2025-09-09 09:40:14,913 - db_manager - DEBUG - execute_update values: ('dust everywhere in the house, the kids are sick, I need to go to the hospital', 'GR-20250909-KOJH-7D5C-B')
2025-09-09 09:40:14,913 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 09:40:14,913 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:14,918 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:14,919 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 09:40:14,920 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 09:40:14,922 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:14,922 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:14,923 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-7D5C-B, rows affected: 1
2025-09-09 09:40:14,923 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-7D5C-B
2025-09-09 09:40:14,923 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:14,928 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:14,928 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 09:40:14,929 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 09:40:14,930 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:14,930 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:14,930 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:14,935 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:14,935 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 09:40:14,937 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 09:40:14,937 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:14,937 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:14,980 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:14,987 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:14,987 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 09:40:14,989 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 09:40:14,989 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:14,989 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:14,990 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-7D5C-B', 'complainant_id': 'CM-20250909-KOJH-FB83-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धूलो सबै ठाउँमा, बच्चाहरू बिरामी छन्, मलाई अस्पताल जान आवश्यक छ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 40, 3, 140094, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 40, 14, 919232, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d040703022059845d2d7a182475d23d01119e48339d7a62985c331da23b068222d80ea42c8dc900a38e51f15a62ca03e989a3b590b4bd964c1eaa64d0bbf0d0c57a2d66de8a95b108915b0157', 'complainant_phone': 'c30d04070302fd6a9ac969b9ece46dd23d01062a7730fad3fb38fca124353d437d5574b11891beca3238d2581cf32debc8d0ad9ef5f2ac657e3a0cc1f1b9e98904b887acd584add77a71afdb0a64', 'complainant_email': 'c30d0407030271c3760d230a94fd7dd23d01e146bc692306bfffc8ec293602257850e3b0676ad76b0cb2a9bb52184c7ab8f76cb6ec04b7726359bc8b314807988dedd90243cd48e111dc023c5bf5', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-7D5C-B', 'complainant_id': 'CM-20250909-KOJH-FB83-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धूलो सबै ठाउँमा, बच्चाहरू बिरामी छन्, मलाई अस्पताल जान आवश्यक छ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 9, 40, 3, 140094, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 9, 40, 14, 919232, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d040703022059845d2d7a182475d23d01119e48339d7a62985c331da23b068222d80ea42c8dc900a38e51f15a62ca03e989a3b590b4bd964c1eaa64d0bbf0d0c57a2d66de8a95b108915b0157', 'complainant_phone': 'c30d04070302fd6a9ac969b9ece46dd23d01062a7730fad3fb38fca124353d437d5574b11891beca3238d2581cf32debc8d0ad9ef5f2ac657e3a0cc1f1b9e98904b887acd584add77a71afdb0a64', 'complainant_email': 'c30d0407030271c3760d230a94fd7dd23d01e146bc692306bfffc8ec293602257850e3b0676ad76b0cb2a9bb52184c7ab8f76cb6ec04b7726359bc8b314807988dedd90243cd48e111dc023c5bf5', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 09:40:19,484 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:19,490 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:19,491 - db_manager - INFO - Executing get_complainant_id_from_grievance_id: 
            SELECT complainant_id
            FROM grievances
            WHERE grievance_id = %s
 ...
2025-09-09 09:40:19,492 - db_manager - INFO - get_complainant_id_from_grievance_id completed in 0.01s. Rows: 1
2025-09-09 09:40:19,492 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:19,492 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:19,492 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-FB83-B
2025-09-09 09:40:19,493 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {}
2025-09-09 09:40:19,493 - db_manager - DEBUG - encrypted_data at update_complainant: {}
2025-09-09 09:40:19,493 - db_manager - DEBUG - No complainant field to update
2025-09-09 09:40:19,493 - db_manager - INFO - Complainant updated in db: GR-20250909-KOJH-7D5C-B
2025-09-09 09:40:19,493 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-7D5C-B
2025-09-09 09:40:19,493 - db_manager - DEBUG - execute_update values: (['{"Environmental - Air Pollution"}'], 'GR-20250909-KOJH-7D5C-B')
2025-09-09 09:40:19,493 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 09:40:19,493 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:19,501 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:19,502 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_categories = %s, grievance...
2025-09-09 09:40:19,503 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 09:40:19,507 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:19,507 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 09:40:19,507 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-7D5C-B, rows affected: 1
2025-09-09 09:40:19,507 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-7D5C-B
2025-09-09 09:40:19,558 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 09:40:19,563 - db_manager - INFO - Starting database transaction
2025-09-09 09:40:19,564 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 09:40:19,565 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 09:40:19,565 - db_manager - INFO - Transaction committed successfully
2025-09-09 09:40:19,565 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:22:48,446 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:22:48,447 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:22:48,447 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:22:48,447 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:22:48,447 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:22:48,447 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:22:48,447 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:22:48,447 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:22:48,447 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:22:48,447 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:22:48,447 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:22:48,447 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:22:48,448 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:22:48,448 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:22:48,448 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:22:48,448 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:22:48,448 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:22:48,448 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:22:48,448 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:22:48,448 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:22:48,448 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:22:48,448 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:22:48,448 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:22:48,448 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:22:48,448 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:22:48,448 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:22:48,448 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:22:48,448 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:22:48,448 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:22:48,448 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:23:36,406 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-DC1A-B
2025-09-09 17:23:36,406 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-DC1A-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-DC1A-B'}
2025-09-09 17:23:36,406 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 17:23:36,406 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 17:23:36,406 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 17:23:36,406 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 17:23:36,407 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:23:36,413 - db_manager - INFO - Starting database transaction
2025-09-09 17:23:36,415 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:23:36,415 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:23:36,415 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-DC1A-B
2025-09-09 17:23:36,415 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-0C52-B', 'complainant_id': 'CM-20250909-KOJH-DC1A-B', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-DC1A-B'}
2025-09-09 17:23:36,416 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-0C52-B
2025-09-09 17:23:36,416 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 17:23:36,416 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 17:23:36,416 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 17:23:36,416 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 17:23:36,416 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:23:36,421 - db_manager - INFO - Starting database transaction
2025-09-09 17:23:36,425 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:23:36,425 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:23:36,426 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-0C52-B
2025-09-09 17:24:12,006 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:24:12,011 - db_manager - INFO - Starting database transaction
2025-09-09 17:24:12,011 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 17:24:12,012 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 17:24:12,013 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:24:12,013 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:24:12,013 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:24:12,017 - db_manager - INFO - Starting database transaction
2025-09-09 17:24:12,017 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 17:24:12,019 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 17:24:12,019 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:24:12,019 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:24:12,019 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-0C52-B', 'complainant_id': 'CM-20250909-KOJH-DC1A-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धूलो छ, बच्चाहरू बिरामी छन्, मलाई अस्पताल जान आवश्यक छ।', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 17, 23, 36, 421181, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 17, 23, 41, 103478, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-0C52-B', 'complainant_id': 'CM-20250909-KOJH-DC1A-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धूलो छ, बच्चाहरू बिरामी छन्, मलाई अस्पताल जान आवश्यक छ।', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 17, 23, 36, 421181, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 17, 23, 41, 103478, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 17:24:12,019 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-DC1A-B
2025-09-09 17:24:12,019 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:24:12,024 - db_manager - INFO - Starting database transaction
2025-09-09 17:24:12,024 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 17:24:12,027 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 17:24:12,027 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:24:12,028 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:24:12,028 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:24:12,032 - db_manager - INFO - Starting database transaction
2025-09-09 17:24:12,032 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 17:24:12,033 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 17:24:12,033 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:24:12,033 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:24:12,033 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d04070302c4119fa2bd57daf660d23d01e441be6176626fa70615bdc235ad6ba09f58acdccaa3592edac3573c66b20ab62df8742405dd71cfa0e8f95106e60785a9a00dd010237ecefea3ff60
2025-09-09 17:24:12,033 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:24:12,038 - db_manager - INFO - Starting database transaction
2025-09-09 17:24:12,038 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 17:24:12,039 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 17:24:12,039 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:24:12,039 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:24:12,039 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 17:24:12,039 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d040703028ce9bbeb9a0bf54d7ad23d01ce86c44157e8d32eead72b53cd221715680c472401dd30d745f0031243cbfacbda4d976af4fd136090ee4f66dacfa338fa500937b0ef06ff747d373e', 'complainant_phone': 'c30d04070302c4119fa2bd57daf660d23d01e441be6176626fa70615bdc235ad6ba09f58acdccaa3592edac3573c66b20ab62df8742405dd71cfa0e8f95106e60785a9a00dd010237ecefea3ff60', 'complainant_email': 'c30d040703024168a8e86af9e8e674d23d0177d1b2befcef83c385ef283de218afc404c7da042195009004b8179626126be52ee1069e166a999e7cf563d25f7fe8e7a44b6426d062bf4e0bf33a72', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 17:24:12,039 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d040703028ce9bbeb9a0bf54d7ad23d01ce86c44157e8d32eead72b53cd221715680c472401dd30d745f0031243cbfacbda4d976af4fd136090ee4f66dacfa338fa500937b0ef06ff747d373e', 'complainant_phone': 'c30d04070302c4119fa2bd57daf660d23d01e441be6176626fa70615bdc235ad6ba09f58acdccaa3592edac3573c66b20ab62df8742405dd71cfa0e8f95106e60785a9a00dd010237ecefea3ff60', 'complainant_email': 'c30d040703024168a8e86af9e8e674d23d0177d1b2befcef83c385ef283de218afc404c7da042195009004b8179626126be52ee1069e166a999e7cf563d25f7fe8e7a44b6426d062bf4e0bf33a72', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 17:24:12,039 - db_manager - DEBUG - execute_update values: ('c30d040703028ce9bbeb9a0bf54d7ad23d01ce86c44157e8d32eead72b53cd221715680c472401dd30d745f0031243cbfacbda4d976af4fd136090ee4f66dacfa338fa500937b0ef06ff747d373e', 'c30d04070302c4119fa2bd57daf660d23d01e441be6176626fa70615bdc235ad6ba09f58acdccaa3592edac3573c66b20ab62df8742405dd71cfa0e8f95106e60785a9a00dd010237ecefea3ff60', 'c30d040703024168a8e86af9e8e674d23d0177d1b2befcef83c385ef283de218afc404c7da042195009004b8179626126be52ee1069e166a999e7cf563d25f7fe8e7a44b6426d062bf4e0bf33a72', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-DC1A-B')
2025-09-09 17:24:12,039 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_full_name_hash = %s, complainant_phone_hash = %s, complainant_email_hash = %s WHERE complainant_id = %s
2025-09-09 17:24:12,039 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:24:12,044 - db_manager - INFO - Starting database transaction
2025-09-09 17:24:12,044 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 17:24:12,044 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 17:24:12,046 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:24:12,046 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:24:12,046 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-DC1A-B
2025-09-09 17:24:12,046 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-0C52-B
2025-09-09 17:24:12,046 - db_manager - DEBUG - execute_update values: ('dust everywhere in the house, the kids are sick, I need to go to the hospital', 'GR-20250909-KOJH-0C52-B')
2025-09-09 17:24:12,046 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 17:24:12,046 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:24:12,050 - db_manager - INFO - Starting database transaction
2025-09-09 17:24:12,051 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 17:24:12,051 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 17:24:12,054 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:24:12,054 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:24:12,054 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-0C52-B, rows affected: 1
2025-09-09 17:24:12,054 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-0C52-B
2025-09-09 17:24:12,054 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:24:12,058 - db_manager - INFO - Starting database transaction
2025-09-09 17:24:12,058 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 17:24:12,060 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 17:24:12,060 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:24:12,060 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:24:12,060 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:24:12,064 - db_manager - INFO - Starting database transaction
2025-09-09 17:24:12,064 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 17:24:12,065 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 17:24:12,065 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:24:12,065 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:24:12,108 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:24:12,113 - db_manager - INFO - Starting database transaction
2025-09-09 17:24:12,114 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 17:24:12,115 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 17:24:12,115 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:24:12,115 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:24:12,116 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-0C52-B', 'complainant_id': 'CM-20250909-KOJH-DC1A-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धूलो छ, बच्चाहरू बिरामी छन्, मलाई अस्पताल जान आवश्यक छ।', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 17, 23, 36, 421181, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 17, 24, 12, 51099, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d040703028ce9bbeb9a0bf54d7ad23d01ce86c44157e8d32eead72b53cd221715680c472401dd30d745f0031243cbfacbda4d976af4fd136090ee4f66dacfa338fa500937b0ef06ff747d373e', 'complainant_phone': 'c30d04070302c4119fa2bd57daf660d23d01e441be6176626fa70615bdc235ad6ba09f58acdccaa3592edac3573c66b20ab62df8742405dd71cfa0e8f95106e60785a9a00dd010237ecefea3ff60', 'complainant_email': 'c30d040703024168a8e86af9e8e674d23d0177d1b2befcef83c385ef283de218afc404c7da042195009004b8179626126be52ee1069e166a999e7cf563d25f7fe8e7a44b6426d062bf4e0bf33a72', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-0C52-B', 'complainant_id': 'CM-20250909-KOJH-DC1A-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धूलो छ, बच्चाहरू बिरामी छन्, मलाई अस्पताल जान आवश्यक छ।', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 17, 23, 36, 421181, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 17, 24, 12, 51099, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d040703028ce9bbeb9a0bf54d7ad23d01ce86c44157e8d32eead72b53cd221715680c472401dd30d745f0031243cbfacbda4d976af4fd136090ee4f66dacfa338fa500937b0ef06ff747d373e', 'complainant_phone': 'c30d04070302c4119fa2bd57daf660d23d01e441be6176626fa70615bdc235ad6ba09f58acdccaa3592edac3573c66b20ab62df8742405dd71cfa0e8f95106e60785a9a00dd010237ecefea3ff60', 'complainant_email': 'c30d040703024168a8e86af9e8e674d23d0177d1b2befcef83c385ef283de218afc404c7da042195009004b8179626126be52ee1069e166a999e7cf563d25f7fe8e7a44b6426d062bf4e0bf33a72', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 17:44:35,997 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:44:35,997 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:44:35,997 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:44:35,997 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:44:35,997 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:44:35,997 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:44:35,997 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:44:35,998 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:44:35,998 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:44:35,998 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:44:35,998 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:44:35,998 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:44:35,998 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:44:35,998 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:44:35,998 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:44:35,998 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:44:35,998 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:44:35,998 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:44:35,998 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:44:35,998 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:44:35,998 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:44:35,998 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:44:35,998 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:44:35,998 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:44:35,998 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:44:35,998 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:44:35,998 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:44:35,998 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:44:35,998 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:44:35,998 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:45:40,478 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-1357-B
2025-09-09 17:45:40,478 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-1357-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-1357-B'}
2025-09-09 17:45:40,478 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 17:45:40,478 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 17:45:40,478 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 17:45:40,478 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 17:45:40,478 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:45:40,485 - db_manager - INFO - Starting database transaction
2025-09-09 17:45:40,487 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:45:40,487 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:45:40,487 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-1357-B
2025-09-09 17:45:40,487 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-5831-B', 'complainant_id': 'CM-20250909-KOJH-1357-B', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-1357-B'}
2025-09-09 17:45:40,487 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-5831-B
2025-09-09 17:45:40,487 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 17:45:40,487 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 17:45:40,487 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 17:45:40,487 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 17:45:40,487 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:45:40,492 - db_manager - INFO - Starting database transaction
2025-09-09 17:45:40,497 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:45:40,497 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:45:40,497 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-5831-B
2025-09-09 17:45:55,551 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:45:55,558 - db_manager - INFO - Starting database transaction
2025-09-09 17:45:55,558 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 17:45:55,559 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 17:45:55,559 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:45:55,559 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:45:55,560 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:45:55,564 - db_manager - INFO - Starting database transaction
2025-09-09 17:45:55,564 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 17:45:55,566 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 17:45:55,566 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:45:55,566 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:45:55,566 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-5831-B', 'complainant_id': 'CM-20250909-KOJH-1357-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धूलो हरेक ठाउँमा, बच्चाहरू बिरामी भए, मलाई अस्पताल जानु पर्छ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 17, 45, 40, 492665, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 17, 45, 45, 718581, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-5831-B', 'complainant_id': 'CM-20250909-KOJH-1357-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धूलो हरेक ठाउँमा, बच्चाहरू बिरामी भए, मलाई अस्पताल जानु पर्छ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 17, 45, 40, 492665, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 17, 45, 45, 718581, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 17:45:55,566 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-1357-B
2025-09-09 17:45:55,566 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:45:55,571 - db_manager - INFO - Starting database transaction
2025-09-09 17:45:55,571 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 17:45:55,573 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 17:45:55,573 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:45:55,573 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:45:55,573 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:45:55,577 - db_manager - INFO - Starting database transaction
2025-09-09 17:45:55,577 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 17:45:55,578 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 17:45:55,578 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:45:55,579 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:45:55,579 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:45:55,583 - db_manager - INFO - Starting database transaction
2025-09-09 17:45:55,583 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 17:45:55,584 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 17:45:55,584 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:45:55,584 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:45:55,584 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d040703022acbfda250f14ce378d23d015ce159ec9b0ee720aa59bfb530319a535fe63f44f5595298ca3c2946ac8c9deedc1514f2c8439013913ef6904750ce3e10bf6a1b11a74c5f50094d0e
2025-09-09 17:45:55,584 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 17:45:55,584 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d040703023d0401a51e4cc2d374d23d018449d6e3d871243ee3bc20f76303f37ec89ddb2523ed0af2007c66558adc3db1e74dbdbcb5bd63f5bf8c08dda77d7f4e3ea7450ec27ef422ef2ab996', 'complainant_phone': 'c30d040703022acbfda250f14ce378d23d015ce159ec9b0ee720aa59bfb530319a535fe63f44f5595298ca3c2946ac8c9deedc1514f2c8439013913ef6904750ce3e10bf6a1b11a74c5f50094d0e', 'complainant_email': 'c30d040703020089d5d9a51cbf8167d23d01dab925fc798a83b39173f2f9a12c0143d317b6f1a663fad334c4654ae76dcd7d136bc769ee9630712ca8d189ace06d4b4429b76d1fdb62b8d42fff34', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 17:45:55,584 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d040703023d0401a51e4cc2d374d23d018449d6e3d871243ee3bc20f76303f37ec89ddb2523ed0af2007c66558adc3db1e74dbdbcb5bd63f5bf8c08dda77d7f4e3ea7450ec27ef422ef2ab996', 'complainant_phone': 'c30d040703022acbfda250f14ce378d23d015ce159ec9b0ee720aa59bfb530319a535fe63f44f5595298ca3c2946ac8c9deedc1514f2c8439013913ef6904750ce3e10bf6a1b11a74c5f50094d0e', 'complainant_email': 'c30d040703020089d5d9a51cbf8167d23d01dab925fc798a83b39173f2f9a12c0143d317b6f1a663fad334c4654ae76dcd7d136bc769ee9630712ca8d189ace06d4b4429b76d1fdb62b8d42fff34', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 17:45:55,584 - db_manager - DEBUG - execute_update values: ('c30d040703023d0401a51e4cc2d374d23d018449d6e3d871243ee3bc20f76303f37ec89ddb2523ed0af2007c66558adc3db1e74dbdbcb5bd63f5bf8c08dda77d7f4e3ea7450ec27ef422ef2ab996', 'c30d040703022acbfda250f14ce378d23d015ce159ec9b0ee720aa59bfb530319a535fe63f44f5595298ca3c2946ac8c9deedc1514f2c8439013913ef6904750ce3e10bf6a1b11a74c5f50094d0e', 'c30d040703020089d5d9a51cbf8167d23d01dab925fc798a83b39173f2f9a12c0143d317b6f1a663fad334c4654ae76dcd7d136bc769ee9630712ca8d189ace06d4b4429b76d1fdb62b8d42fff34', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-1357-B')
2025-09-09 17:45:55,584 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_email_hash = %s, complainant_full_name_hash = %s, complainant_phone_hash = %s WHERE complainant_id = %s
2025-09-09 17:45:55,584 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:45:55,589 - db_manager - INFO - Starting database transaction
2025-09-09 17:45:55,589 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 17:45:55,590 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 17:45:55,592 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:45:55,592 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:45:55,592 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-1357-B
2025-09-09 17:45:55,592 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-5831-B
2025-09-09 17:45:55,592 - db_manager - DEBUG - execute_update values: ('dust everywhere in the house, the kids are sick, I need to go to the hospital', 'GR-20250909-KOJH-5831-B')
2025-09-09 17:45:55,592 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 17:45:55,592 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:45:55,597 - db_manager - INFO - Starting database transaction
2025-09-09 17:45:55,597 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 17:45:55,598 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 17:45:55,600 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:45:55,600 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:45:55,600 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-5831-B, rows affected: 1
2025-09-09 17:45:55,600 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-5831-B
2025-09-09 17:45:55,600 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:45:55,604 - db_manager - INFO - Starting database transaction
2025-09-09 17:45:55,604 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 17:45:55,605 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 17:45:55,606 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:45:55,606 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:45:55,606 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:45:55,610 - db_manager - INFO - Starting database transaction
2025-09-09 17:45:55,610 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 17:45:55,611 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 17:45:55,611 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:45:55,611 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:45:55,652 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 17:45:55,659 - db_manager - INFO - Starting database transaction
2025-09-09 17:45:55,659 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 17:45:55,662 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 17:45:55,662 - db_manager - INFO - Transaction committed successfully
2025-09-09 17:45:55,663 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 17:45:55,663 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-5831-B', 'complainant_id': 'CM-20250909-KOJH-1357-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धूलो हरेक ठाउँमा, बच्चाहरू बिरामी भए, मलाई अस्पताल जानु पर्छ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 17, 45, 40, 492665, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 17, 45, 55, 597636, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d040703023d0401a51e4cc2d374d23d018449d6e3d871243ee3bc20f76303f37ec89ddb2523ed0af2007c66558adc3db1e74dbdbcb5bd63f5bf8c08dda77d7f4e3ea7450ec27ef422ef2ab996', 'complainant_phone': 'c30d040703022acbfda250f14ce378d23d015ce159ec9b0ee720aa59bfb530319a535fe63f44f5595298ca3c2946ac8c9deedc1514f2c8439013913ef6904750ce3e10bf6a1b11a74c5f50094d0e', 'complainant_email': 'c30d040703020089d5d9a51cbf8167d23d01dab925fc798a83b39173f2f9a12c0143d317b6f1a663fad334c4654ae76dcd7d136bc769ee9630712ca8d189ace06d4b4429b76d1fdb62b8d42fff34', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-5831-B', 'complainant_id': 'CM-20250909-KOJH-1357-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धूलो हरेक ठाउँमा, बच्चाहरू बिरामी भए, मलाई अस्पताल जानु पर्छ', 'grievance_description': 'dust everywhere in the house, the kids are sick, I need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 17, 45, 40, 492665, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 17, 45, 55, 597636, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d040703023d0401a51e4cc2d374d23d018449d6e3d871243ee3bc20f76303f37ec89ddb2523ed0af2007c66558adc3db1e74dbdbcb5bd63f5bf8c08dda77d7f4e3ea7450ec27ef422ef2ab996', 'complainant_phone': 'c30d040703022acbfda250f14ce378d23d015ce159ec9b0ee720aa59bfb530319a535fe63f44f5595298ca3c2946ac8c9deedc1514f2c8439013913ef6904750ce3e10bf6a1b11a74c5f50094d0e', 'complainant_email': 'c30d040703020089d5d9a51cbf8167d23d01dab925fc798a83b39173f2f9a12c0143d317b6f1a663fad334c4654ae76dcd7d136bc769ee9630712ca8d189ace06d4b4429b76d1fdb62b8d42fff34', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 17:50:20,899 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:50:20,900 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:50:20,900 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:50:20,900 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:50:20,900 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:50:20,900 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:50:20,900 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:50:20,900 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:50:20,900 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:50:20,900 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:50:20,900 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:50:20,900 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:50:20,900 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:50:20,900 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:50:20,900 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:50:20,900 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:50:20,900 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:50:20,900 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:50:20,901 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:50:20,901 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:50:20,901 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:50:20,901 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:50:20,901 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:50:20,901 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:50:20,901 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:50:20,901 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:50:20,901 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 17:50:20,901 - db_manager - INFO - Database parameters: {'host': 'localhost', 'database': 'grievance_db', 'user': 'nepal_grievance_admin', 'password': 'K9!mP2$vL5nX8&qR4jW7', 'port': '5432'}
2025-09-09 17:50:20,901 - db_manager - INFO - Database manager initialized successfully
2025-09-09 17:50:20,901 - db_manager - INFO - Encryption enabled for sensitive fields
2025-09-09 18:14:43,506 - db_manager - INFO - create_complainant: Creating complainant with ID: CM-20250909-KOJH-E009-B
2025-09-09 18:14:43,507 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_id': 'CM-20250909-KOJH-E009-B', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_unique_id': 'CM-20250909-KOJH-E009-B'}
2025-09-09 18:14:43,507 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['complainant_id', 'complainant_province', 'complainant_district', 'complainant_unique_id'])
2025-09-09 18:14:43,507 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 18:14:43,507 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 18:14:43,507 - db_manager - DEBUG - Generated query: INSERT INTO complainants (complainant_id, complainant_province, complainant_district, complainant_unique_id) VALUES (%s, %s, %s, %s)
2025-09-09 18:14:43,507 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 18:14:43,515 - db_manager - INFO - Starting database transaction
2025-09-09 18:14:43,522 - db_manager - INFO - Transaction committed successfully
2025-09-09 18:14:43,522 - db_manager - INFO - Database connection closed. Duration: 0.02s
2025-09-09 18:14:43,522 - db_manager - INFO - create_complainant: Successfully created complainant with ID: CM-20250909-KOJH-E009-B
2025-09-09 18:14:43,522 - db_manager - INFO - create_grievance: Creating grievance with data: {'grievance_id': 'GR-20250909-KOJH-A333-B', 'complainant_id': 'CM-20250909-KOJH-E009-B', 'grievance_description': 'dust everywhere in my house\nkids are coughing\ni need to go to the hospital', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_office': None, 'source': 'bot', 'complainant_unique_id': 'CM-20250909-KOJH-E009-B'}
2025-09-09 18:14:43,522 - db_manager - INFO - create_grievance: Creating grievance with ID: GR-20250909-KOJH-A333-B
2025-09-09 18:14:43,522 - db_manager - DEBUG - query_keys at generate_query_string: dict_keys(['grievance_id', 'complainant_id', 'grievance_description', 'source'])
2025-09-09 18:14:43,522 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 18:14:43,523 - db_manager - DEBUG - len of query_keys: 4
2025-09-09 18:14:43,523 - db_manager - DEBUG - Generated query: INSERT INTO grievances (grievance_id, complainant_id, grievance_description, source) VALUES (%s, %s, %s, %s) RETURNING grievance_id
2025-09-09 18:14:43,523 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 18:14:43,528 - db_manager - INFO - Starting database transaction
2025-09-09 18:14:43,533 - db_manager - INFO - Transaction committed successfully
2025-09-09 18:14:43,533 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 18:14:43,533 - db_manager - INFO - create_grievance: Successfully created grievance with ID: GR-20250909-KOJH-A333-B
2025-09-09 18:15:02,153 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 18:15:02,158 - db_manager - INFO - Starting database transaction
2025-09-09 18:15:02,159 - db_manager - INFO - Executing get_complainant_by_id: 
            SELECT complainant_id, complainant_unique_id, complainant_full_name,    complainant_pho...
2025-09-09 18:15:02,160 - db_manager - INFO - get_complainant_by_id completed in 0.01s. Rows: 1
2025-09-09 18:15:02,160 - db_manager - INFO - Transaction committed successfully
2025-09-09 18:15:02,160 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 18:15:02,160 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 18:15:02,165 - db_manager - INFO - Starting database transaction
2025-09-09 18:15:02,165 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 18:15:02,167 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 18:15:02,167 - db_manager - INFO - Transaction committed successfully
2025-09-09 18:15:02,167 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 18:15:02,167 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-A333-B', 'complainant_id': 'CM-20250909-KOJH-E009-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धुलो हरेक ठाउँमा। बच्चाहरु खोक्दै छन्। अस्पताल जान आवश्यकता छ।', 'grievance_description': 'dust everywhere in my house\nkids are coughing\ni need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 18, 14, 43, 528319, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 18, 14, 48, 11800, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-A333-B', 'complainant_id': 'CM-20250909-KOJH-E009-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धुलो हरेक ठाउँमा। बच्चाहरु खोक्दै छन्। अस्पताल जान आवश्यकता छ।', 'grievance_description': 'dust everywhere in my house\nkids are coughing\ni need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 18, 14, 43, 528319, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 18, 14, 48, 11800, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': None, 'complainant_phone': None, 'complainant_email': None, 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
2025-09-09 18:15:02,167 - db_manager - INFO - update_complainant: Updating complainant with ID: CM-20250909-KOJH-E009-B
2025-09-09 18:15:02,168 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 18:15:02,172 - db_manager - INFO - Starting database transaction
2025-09-09 18:15:02,172 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 18:15:02,174 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 18:15:02,175 - db_manager - INFO - Transaction committed successfully
2025-09-09 18:15:02,175 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 18:15:02,175 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 18:15:02,179 - db_manager - INFO - Starting database transaction
2025-09-09 18:15:02,179 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 18:15:02,180 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 18:15:02,180 - db_manager - INFO - Transaction committed successfully
2025-09-09 18:15:02,180 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 18:15:02,181 - db_manager - DEBUG - encrypted phone number Not provided at encrypt_complainant_data: c30d04070302c96bf3d26de9ab067ad23d01c4f4279a6682282e212bf91f322fe1552bb3a64ad4724df83150d0b9f7db9e861decc889218c5d194862901e53e9b0a3ea093ea75b04c3d43eb53269
2025-09-09 18:15:02,181 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 18:15:02,185 - db_manager - INFO - Starting database transaction
2025-09-09 18:15:02,185 - db_manager - INFO - Executing encrypt_field: SELECT encode(pgp_sym_encrypt(%s, %s), 'hex') AS encrypted...
2025-09-09 18:15:02,186 - db_manager - INFO - encrypt_field completed in 0.01s. Rows: 1
2025-09-09 18:15:02,186 - db_manager - INFO - Transaction committed successfully
2025-09-09 18:15:02,186 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 18:15:02,186 - db_manager - DEBUG - phone number Not provided hashed to d83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f at hash_sensitive_data
2025-09-09 18:15:02,186 - db_manager - DEBUG - encrypted and hashed data at encrypt_and_hash_sensitive_data: {'complainant_full_name': 'c30d040703027a09dce12f1c876f6fd23d0134b3c4317b71ca2dff889c64ab3175c49c59a7d306dfd499c758f1a1f68b31443a9734e34a806c7ba85690f8c034f96e0fca63b3cf46382287cdc0c2', 'complainant_phone': 'c30d04070302c96bf3d26de9ab067ad23d01c4f4279a6682282e212bf91f322fe1552bb3a64ad4724df83150d0b9f7db9e861decc889218c5d194862901e53e9b0a3ea093ea75b04c3d43eb53269', 'complainant_email': 'c30d04070302a9137f917463b8e260d23d019465fb574033e25062e4202faf3f63cebdc5b332bcd57a991e2854088a60a2e8611749b65a972b9f4d9136bb3f890c7943f0a5034cb03aa2ef889458', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 18:15:02,186 - db_manager - DEBUG - encrypted_data at update_complainant: {'complainant_full_name': 'c30d040703027a09dce12f1c876f6fd23d0134b3c4317b71ca2dff889c64ab3175c49c59a7d306dfd499c758f1a1f68b31443a9734e34a806c7ba85690f8c034f96e0fca63b3cf46382287cdc0c2', 'complainant_phone': 'c30d04070302c96bf3d26de9ab067ad23d01c4f4279a6682282e212bf91f322fe1552bb3a64ad4724df83150d0b9f7db9e861decc889218c5d194862901e53e9b0a3ea093ea75b04c3d43eb53269', 'complainant_email': 'c30d04070302a9137f917463b8e260d23d019465fb574033e25062e4202faf3f63cebdc5b332bcd57a991e2854088a60a2e8611749b65a972b9f4d9136bb3f890c7943f0a5034cb03aa2ef889458', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_email_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_phone_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'complainant_full_name_hash': 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f'}
2025-09-09 18:15:02,186 - db_manager - DEBUG - execute_update values: ('c30d040703027a09dce12f1c876f6fd23d0134b3c4317b71ca2dff889c64ab3175c49c59a7d306dfd499c758f1a1f68b31443a9734e34a806c7ba85690f8c034f96e0fca63b3cf46382287cdc0c2', 'c30d04070302c96bf3d26de9ab067ad23d01c4f4279a6682282e212bf91f322fe1552bb3a64ad4724df83150d0b9f7db9e861decc889218c5d194862901e53e9b0a3ea093ea75b04c3d43eb53269', 'c30d04070302a9137f917463b8e260d23d019465fb574033e25062e4202faf3f63cebdc5b332bcd57a991e2854088a60a2e8611749b65a972b9f4d9136bb3f890c7943f0a5034cb03aa2ef889458', 'Koshi', 'Jhapa', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'd83b9ff3c07a8390e2ea0a2af45fba37595da25f31b85ba625363ee98c0c796f', 'CM-20250909-KOJH-E009-B')
2025-09-09 18:15:02,186 - db_manager - DEBUG - execute_update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, complainant_province = %s, complainant_district = %s, complainant_email_hash = %s, complainant_phone_hash = %s, complainant_full_name_hash = %s WHERE complainant_id = %s
2025-09-09 18:15:02,186 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 18:15:02,190 - db_manager - INFO - Starting database transaction
2025-09-09 18:15:02,191 - db_manager - INFO - execute_update: Executing update query: UPDATE complainants SET complainant_full_name = %s, complainant_phone = %s, complainant_email = %s, ...
2025-09-09 18:15:02,191 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 18:15:02,193 - db_manager - INFO - Transaction committed successfully
2025-09-09 18:15:02,193 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 18:15:02,193 - db_manager - INFO - Complainant updated in db: CM-20250909-KOJH-E009-B
2025-09-09 18:15:02,193 - db_manager - INFO - update_grievance: Updating grievance with ID: GR-20250909-KOJH-A333-B
2025-09-09 18:15:02,193 - db_manager - DEBUG - execute_update values: ('dust everywhere in my house\nkids are coughing\ni need to go to the hospital', 'GR-20250909-KOJH-A333-B')
2025-09-09 18:15:02,193 - db_manager - DEBUG - execute_update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievance_modification_date = CURRENT_TIMESTAMP
                    WHERE grievance_id = %s
                    RETURNING grievance_id
                
2025-09-09 18:15:02,193 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 18:15:02,198 - db_manager - INFO - Starting database transaction
2025-09-09 18:15:02,198 - db_manager - INFO - execute_update: Executing update query: 
                    UPDATE grievances 
                    SET grievance_description = %s, grievanc...
2025-09-09 18:15:02,199 - db_manager - INFO - execute_update: Update completed in 0.01s. Affected rows: 1
2025-09-09 18:15:02,201 - db_manager - INFO - Transaction committed successfully
2025-09-09 18:15:02,201 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 18:15:02,201 - db_manager - INFO - update_grievance: Updated grievance with ID: GR-20250909-KOJH-A333-B, rows affected: 1
2025-09-09 18:15:02,201 - db_manager - INFO - Grievance updated in db: GR-20250909-KOJH-A333-B
2025-09-09 18:15:02,201 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 18:15:02,206 - db_manager - INFO - Starting database transaction
2025-09-09 18:15:02,206 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 18:15:02,207 - db_manager - INFO - get_grievance_files completed in 0.01s. Rows: 0
2025-09-09 18:15:02,207 - db_manager - INFO - Transaction committed successfully
2025-09-09 18:15:02,207 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 18:15:02,207 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 18:15:02,211 - db_manager - INFO - Starting database transaction
2025-09-09 18:15:02,211 - db_manager - INFO - Executing get_grievance_files: 
            SELECT file_id, file_name, file_type, file_size, upload_timestamp
            FROM file...
2025-09-09 18:15:02,212 - db_manager - INFO - get_grievance_files completed in 0.00s. Rows: 0
2025-09-09 18:15:02,212 - db_manager - INFO - Transaction committed successfully
2025-09-09 18:15:02,212 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 18:15:02,254 - db_manager - INFO - Connecting to database: grievance_db
2025-09-09 18:15:02,259 - db_manager - INFO - Starting database transaction
2025-09-09 18:15:02,259 - db_manager - INFO - Executing get_grievance_by_id: 
                SELECT g.*, c.complainant_full_name, c.complainant_phone, c.complainant_email,
    ...
2025-09-09 18:15:02,261 - db_manager - INFO - get_grievance_by_id completed in 0.01s. Rows: 1
2025-09-09 18:15:02,261 - db_manager - INFO - Transaction committed successfully
2025-09-09 18:15:02,261 - db_manager - INFO - Database connection closed. Duration: 0.01s
2025-09-09 18:15:02,261 - db_manager - DEBUG - get_grievance_by_id: grievance_id: {'grievance_id': 'GR-20250909-KOJH-A333-B', 'complainant_id': 'CM-20250909-KOJH-E009-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धुलो हरेक ठाउँमा। बच्चाहरु खोक्दै छन्। अस्पताल जान आवश्यकता छ।', 'grievance_description': 'dust everywhere in my house\nkids are coughing\ni need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 18, 14, 43, 528319, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 18, 15, 2, 198501, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d040703027a09dce12f1c876f6fd23d0134b3c4317b71ca2dff889c64ab3175c49c59a7d306dfd499c758f1a1f68b31443a9734e34a806c7ba85690f8c034f96e0fca63b3cf46382287cdc0c2', 'complainant_phone': 'c30d04070302c96bf3d26de9ab067ad23d01c4f4279a6682282e212bf91f322fe1552bb3a64ad4724df83150d0b9f7db9e861decc889218c5d194862901e53e9b0a3ea093ea75b04c3d43eb53269', 'complainant_email': 'c30d04070302a9137f917463b8e260d23d019465fb574033e25062e4202faf3f63cebdc5b332bcd57a991e2854088a60a2e8611749b65a972b9f4d9136bb3f890c7943f0a5034cb03aa2ef889458', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}, results: [{'grievance_id': 'GR-20250909-KOJH-A333-B', 'complainant_id': 'CM-20250909-KOJH-E009-B', 'grievance_categories': '{"Environmental - Air Pollution"}', 'grievance_summary': 'घरमा धुलो हरेक ठाउँमा। बच्चाहरु खोक्दै छन्। अस्पताल जान आवश्यकता छ।', 'grievance_description': 'dust everywhere in my house\nkids are coughing\ni need to go to the hospital', 'grievance_claimed_amount': None, 'grievance_location': None, 'language_code': 'en', 'classification_status': 'pending', 'grievance_creation_date': datetime.datetime(2025, 9, 9, 18, 14, 43, 528319, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'grievance_modification_date': datetime.datetime(2025, 9, 9, 18, 15, 2, 198501, tzinfo=datetime.timezone(datetime.timedelta(seconds=28800))), 'is_temporary': True, 'source': 'bot', 'complainant_full_name': 'c30d040703027a09dce12f1c876f6fd23d0134b3c4317b71ca2dff889c64ab3175c49c59a7d306dfd499c758f1a1f68b31443a9734e34a806c7ba85690f8c034f96e0fca63b3cf46382287cdc0c2', 'complainant_phone': 'c30d04070302c96bf3d26de9ab067ad23d01c4f4279a6682282e212bf91f322fe1552bb3a64ad4724df83150d0b9f7db9e861decc889218c5d194862901e53e9b0a3ea093ea75b04c3d43eb53269', 'complainant_email': 'c30d04070302a9137f917463b8e260d23d019465fb574033e25062e4202faf3f63cebdc5b332bcd57a991e2854088a60a2e8611749b65a972b9f4d9136bb3f890c7943f0a5034cb03aa2ef889458', 'complainant_province': 'Koshi', 'complainant_district': 'Jhapa', 'complainant_municipality': None, 'complainant_ward': None, 'complainant_village': None, 'complainant_address': None}]
